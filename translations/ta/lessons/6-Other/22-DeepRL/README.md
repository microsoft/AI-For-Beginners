# роЖро┤рооро╛рой рокро▓ройро│ро┐роХрпНроХрпБроорпН роХро▒рпНро▒ро▓рпН

рокро▓ройро│ро┐роХрпНроХрпБроорпН роХро▒рпНро▒ро▓рпН (Reinforcement Learning - RL) роОройрпНрокродрпБ роорпЗро▒рпНрокро╛ро░рпНро╡рпИ роХро▒рпНро▒ро▓рпН рооро▒рпНро▒рпБроорпН роорпЗро▒рпНрокро╛ро░рпНро╡рпИропро▒рпНро▒ роХро▒рпНро▒ро▓рпБроХрпНроХрпБ роЕроЯрпБродрпНродродро╛роХ роЙро│рпНро│ роЕроЯро┐рокрпНрокроЯрпИ роЗропроирпНродро┐ро░ роХро▒рпНро▒ро▓рпН роорпБро▒рпИроХро│ро┐ро▓рпН роТройрпНро▒ро╛роХроХрпН роХро░рпБродрокрпНрокроЯрпБроХро┐ро▒родрпБ. роорпЗро▒рпНрокро╛ро░рпНро╡рпИ роХро▒рпНро▒ро▓ро┐ро▓рпН роиро╛роорпН роЕро▒ро┐ропрокрпНрокроЯрпНроЯ роорпБроЯро┐ро╡рпБроХро│рпБроЯройрпН роХрпВроЯро┐роп родро░ро╡рпБродрпНродрпКроХрпБрокрпНрокрпИ роироорпНрокрпБроХро┐ро▒рпЛроорпН, роЖройро╛ро▓рпН RL роОройрпНрокродрпБ **роЪрпЖропрпНродрпБ роХро▒рпНро▒ро▓рпН** роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН роЪрпЖропро▓рпНрокроЯрпБроХро┐ро▒родрпБ. роЙродро╛ро░рогрооро╛роХ, роорпБродро▓ро┐ро▓рпН роТро░рпБ роХрогро┐ройро┐ ро╡ро┐ро│рпИропро╛роЯрпНроЯрпИрокрпН рокро╛ро░рпНроХрпНроХрпБроорпНрокрпЛродрпБ, ро╡ро┐родро┐роХро│рпИ роЕро▒ро┐ропро╛рооро▓рпН ро╡ро┐ро│рпИропро╛роЯродрпН родрпКроЯроЩрпНроХрпБроХро┐ро▒рпЛроорпН, рокро┐ройрпНройро░рпН ро╡ро┐ро│рпИропро╛роЯро┐, роироородрпБ роироЯродрпНродрпИ рооро╛ро▒рпНро▒рпБро╡родройрпН роорпВро▓роорпН родро┐ро▒ройрпНроХро│рпИ роорпЗроорпНрокроЯрпБродрпНрод роорпБроЯро┐роХро┐ро▒родрпБ.

## [роорпБройрпН-ро╡роХрпБрокрпНрокрпБ ро╡ро┐ройро╛роЯро┐ ро╡ро┐ройро╛](https://ff-quizzes.netlify.app/en/ai/quiz/43)

RL роЪрпЖропрпНроп, роироороХрпНроХрпБ родрпЗро╡рпИропро╛ройро╡рпИ:

* **роЪрпБро▒рпНро▒рпБрокрпНрокрпБро▒роорпН** роЕро▓рпНро▓родрпБ **роЪро┐роорпБро▓рпЗроЯрпНроЯро░рпН**, роЗродрпБ ро╡ро┐ро│рпИропро╛роЯрпНроЯро┐ройрпН ро╡ро┐родро┐роХро│рпИ роЕроорпИроХрпНроХро┐ро▒родрпБ. роЪро┐роорпБро▓рпЗроЯрпНроЯро░ро┐ро▓рпН рокро░ро┐роЪрпЛродройрпИроХро│рпИ роЗропроХрпНроХро┐ роЕродройрпН роорпБроЯро┐ро╡рпБроХро│рпИ роХро╡ройро┐роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН.
* **рокро░ро┐роЪрпБ роЪрпЖропро▓рпНрокро╛роЯрпБ**, роЗродрпБ роироородрпБ рокро░ро┐роЪрпЛродройрпИ роОро╡рпНро╡ро│ро╡рпБ ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роЗро░рпБроирпНродродрпБ роОройрпНрокродрпИ роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ. роХрогро┐ройро┐ ро╡ро┐ро│рпИропро╛роЯрпНроЯрпИ ро╡ро┐ро│рпИропро╛роЯ роХро▒рпНро▒рпБроХрпНроХрпКро│рпНро╡родро▒рпНроХро╛рой роЪрпВро┤ро▓ро┐ро▓рпН, рокро░ро┐роЪрпБ роОройрпНрокродрпБ роЗро▒рпБродро┐роХрпН роХрогроХрпНроХро╛роХ роЗро░рпБроХрпНроХрпБроорпН.

рокро░ро┐роЪрпБ роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН, роироородрпБ роироЯродрпНродрпИ рооро╛ро▒рпНро▒ро┐ родро┐ро▒ройрпНроХро│рпИ роорпЗроорпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН, роЕроЯрпБродрпНрод роорпБро▒рпИ роиройрпНро▒ро╛роХ ро╡ро┐ро│рпИропро╛роЯрпБро╡родро▒рпНроХро╛роХ. рооро▒рпНро▒ роЗропроирпНродро┐ро░ роХро▒рпНро▒ро▓рпН ро╡роХрпИроХро│рпБроХрпНроХрпБроорпН RL-роХрпНроХрпБроорпН роЙро│рпНро│ роорпБроХрпНроХро┐роп ро╡ро┐родрпНродро┐ропро╛роЪроорпН роОройрпНройро╡рпЖройрпНро▒ро╛ро▓рпН, RL-ро▓рпН роиро╛роорпН ро╡ро┐ро│рпИропро╛роЯрпНроЯрпИ роорпБроЯро┐роХрпНроХрпБроорпНро╡ро░рпИ ро╡рпЖро▒рпНро▒ро┐ роЕро▓рпНро▓родрпБ родрпЛро▓рпНро╡ро┐ роОройрпНрокродрпИ роЕро▒ро┐роп роорпБроЯро┐ропро╛родрпБ. роОройро╡рпЗ, роТро░рпБ роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯ роироХро░рпНро╡рпБ родройро┐ропро╛роХ роиро▓рпНро▓родро╛ роЗро▓рпНро▓рпИропро╛ роОройрпНрокродрпИ роХрпВро▒ роорпБроЯро┐ропро╛родрпБ - ро╡ро┐ро│рпИропро╛роЯрпНроЯро┐ройрпН роорпБроЯро┐ро╡ро┐ро▓рпН роороЯрпНроЯрпБроорпЗ рокро░ро┐роЪрпБ роХро┐роЯрпИроХрпНроХрпБроорпН.

RL роЪрпЖропрпНропрпБроорпНрокрпЛродрпБ, рокро▓ рокро░ро┐роЪрпЛродройрпИроХро│рпИ роироЯродрпНродрпБроХро┐ро▒рпЛроорпН. роТро╡рпНро╡рпКро░рпБ рокро░ро┐роЪрпЛродройрпИропро┐ро▓рпБроорпН, роЗродрпБро╡ро░рпИ роХро▒рпНро▒рпБроХрпНроХрпКрогрпНроЯ роЪро┐ро▒роирпНрод роЙродрпНродро┐ропрпИ рокро┐ройрпНрокро▒рпНро▒рпБро╡родро▒рпНроХрпБроорпН (**рокропройрпНрокро╛роЯрпБ**) рокрпБродро┐роп роиро┐ро▓рпИроХро│рпИ роЖро░ро╛ропрпНро╡родро▒рпНроХрпБроорпН (**роЖро░ро╛ропрпНроЪрпНроЪро┐**) роЗроЯрпИропрпЗ роЪроороиро┐ро▓рпИропрпИ роПро▒рпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН.

## OpenAI Gym

RL роХрпНроХро╛рой роТро░рпБ роЪро┐ро▒роирпНрод роХро░рпБро╡ро┐ [OpenAI Gym](https://gym.openai.com/) роЖроХрпБроорпН - роЗродрпБ рокро▓рпНро╡рпЗро▒рпБ роЪрпВро┤ро▓рпНроХро│рпИ роЪро┐роорпБро▓рпЗроЯрпН роЪрпЖропрпНропрпБроорпН **роЪро┐роорпБро▓рпЗро╖ройрпН роЪрпВро┤ро▓рпН**. роЗродрпБ Atari ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпН роорпБродро▓рпН родрогрпНроЯрпИ роЪроороиро┐ро▓рпИропрпИрокрпН рокро┐ройрпНрокро▒рпНро▒рпБроорпН роЗропро▒рпНрокро┐ропро▓рпН ро╡ро░рпИ рокро▓ роЪрпВро┤ро▓рпНроХро│рпИ роЪро┐роорпБро▓рпЗроЯрпН роЪрпЖропрпНроп роорпБроЯро┐ропрпБроорпН. роЗродрпБ рокро▓ройро│ро┐роХрпНроХрпБроорпН роХро▒рпНро▒ро▓рпН роЕро▓рпНроХро╛ро░ро┐родроЩрпНроХро│рпИрокрпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНроп рооро┐роХро╡рпБроорпН рокро┐ро░рокро▓рооро╛рой роЪро┐роорпБро▓рпЗро╖ройрпН роЪрпВро┤ро▓рпНроХро│ро┐ро▓рпН роТройрпНро▒ро╛роХрпБроорпН, роорпЗро▓рпБроорпН [OpenAI](https://openai.com/) роорпВро▓роорпН рокро░ро╛рооро░ро┐роХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ.

> **роХрпБро▒ро┐рокрпНрокрпБ**: OpenAI Gym-ро▓рпН роХро┐роЯрпИроХрпНроХрпБроорпН роЕройрпИродрпНродрпБ роЪрпВро┤ро▓рпНроХро│рпИропрпБроорпН [роЗроЩрпНроХрпЗ](https://gym.openai.com/envs/#classic_control) рокро╛ро░рпНроХрпНроХро▓ро╛роорпН.

## CartPole роЪроороиро┐ро▓рпИ

роирпАроЩрпНроХро│рпН роЕройрпИро╡ро░рпБроорпН *Segway* роЕро▓рпНро▓родрпБ *Gyroscooters* рокрпЛройрпНро▒ роЪроороиро┐ро▓рпИ роЪро╛родройроЩрпНроХро│рпИ роХрогрпНроЯро┐ро░рпБрокрпНрокрпАро░рпНроХро│рпН. роЕро╡рпИ родро╛ройро╛роХро╡рпЗ роЪроороиро┐ро▓рпИропрпИрокрпН рокрпЗрог роорпБроЯро┐ропрпБроорпН, роЕродро╛ро╡родрпБ accelerometer роЕро▓рпНро▓родрпБ gyroscope-ро▓рпН роЗро░рпБроирпНродрпБ ро╡ро░рпБроорпН роЪро┐роХрпНройро▓рпБроХрпНроХрпБ рокродро┐ро▓ро│ро┐родрпНродрпБ роЕродройрпН роЪроХрпНроХро░роЩрпНроХро│рпИ роЪро░ро┐роЪрпЖропрпНродрпБ. роЗроирпНрод рокро┐ро░ро┐ро╡ро┐ро▓рпН, роТро░рпБ родрогрпНроЯрпИ роЪроороиро┐ро▓рпИропрпИрокрпН рокрпЗрогрпБро╡родрпБ рокрпЛройрпНро▒ роТро░рпБ рокро┐ро░роЪрпНроЪро┐ройрпИропрпИ роОро╡рпНро╡ро╛ро▒рпБ родрпАро░рпНроХрпНроХро▓ро╛роорпН роОройрпНрокродрпИ роХро▒рпНро▒рпБроХрпНроХрпКро│рпНро╡рпЛроорпН. роЗродрпБ роТро░рпБ роЪро┐ро░рпНроХрпНроХро╕рпН роХро▓рпИроЮро░рпН родройродрпБ роХрпИропро┐ро▓рпН родрогрпНроЯрпИ роЪроороиро┐ро▓рпИропрпИрокрпН рокрпЗрогрпБро╡родрпБ рокрпЛройрпНро▒родрпБ - роЖройро╛ро▓рпН роЗроирпНрод родрогрпНроЯрпИ роЪроороиро┐ро▓рпИ 1D-ро▓рпН роороЯрпНроЯрпБроорпЗ роиро┐роХро┤рпНроХро┐ро▒родрпБ.

роЪроороиро┐ро▓рпИропро┐ройрпН роОро│ро┐роорпИропро╛рой рокродро┐рокрпНрокрпБ **CartPole** рокро┐ро░роЪрпНроЪро┐ройрпИропро╛роХ роЕро▒ро┐ропрокрпНрокроЯрпБроХро┐ро▒родрпБ. CartPole роЙро▓роХро┐ро▓рпН, роЗроЯродрпБ роЕро▓рпНро▓родрпБ ро╡ро▓родрпБ роирпЛроХрпНроХро┐ роироХро░рпБроорпН роТро░рпБ роХро┐роЯрпИроороЯрпНроЯ ро╕рпНро▓рпИроЯро░рпН роЙро│рпНро│родрпБ, роорпЗро▓рпБроорпН роЗро▓роХрпНроХрпБ роОройрпНрокродрпБ ро╕рпНро▓рпИроЯро░ро┐ройрпН роорпЗро▓рпН роТро░рпБ роЪрпЖроЩрпНроХрпБродрпНродрпБ родрогрпНроЯрпИ роЪроороиро┐ро▓рпИропрпИрокрпН рокрпЗрогрпБро╡родрпБ.

<img alt="роТро░рпБ CartPole" src="../../../../../translated_images/ta/cartpole.f52a67f27e058170.webp" width="200"/>

роЗроирпНрод роЪрпВро┤ро▓рпИ роЙро░рпБро╡ро╛роХрпНроХро┐ рокропройрпНрокроЯрпБродрпНрод, Python роХрпЛроЯро┐ройрпН роЪро┐ро▓ ро╡ро░ро┐роХро│рпН родрпЗро╡рпИ:

```python
import gym
env = gym.make("CartPole-v1")

env.reset()
done = False
total_reward = 0
while not done:
   env.render()
   action = env.action_space.sample()
   observaton, reward, done, info = env.step(action)
   total_reward += reward

print(f"Total reward: {total_reward}")
```

роТро╡рпНро╡рпКро░рпБ роЪрпВро┤ро▓рпИропрпБроорпН роТро░рпЗ ро╡ро┤ро┐ропро┐ро▓рпН роЕрогрпБроХро▓ро╛роорпН:
* `env.reset` роТро░рпБ рокрпБродро┐роп рокро░ро┐роЪрпЛродройрпИропрпИродрпН родрпКроЯроЩрпНроХрпБроХро┐ро▒родрпБ
* `env.step` роТро░рпБ роЪро┐роорпБро▓рпЗро╖ройрпН рокроЯро┐ропрпИроЪрпН роЪрпЖропрпНроХро┐ро▒родрпБ. роЗродрпБ **action space**-ро▓рпН роЗро░рпБроирпНродрпБ роТро░рпБ **action**-роР рокрпЖро▒рпБроХро┐ро▒родрпБ, роорпЗро▓рпБроорпН **observation space**-ро▓рпН роЗро░рпБроирпНродрпБ роТро░рпБ **observation**, рокро░ро┐роЪрпБ рооро▒рпНро▒рпБроорпН роорпБроЯро┐ро╡рпБ роХрпКроЯро┐ роЖроХро┐ропро╡ро▒рпНро▒рпИ родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрокрпБроХро┐ро▒родрпБ.

роорпЗро▓рпЗ роЙро│рпНро│ роЙродро╛ро░рогродрпНродро┐ро▓рпН, роТро╡рпНро╡рпКро░рпБ рокроЯро┐ропро┐ро▓рпБроорпН роТро░рпБ роЪрпАро░ро▒рпНро▒ роЪрпЖропро▓рпИроЪрпН роЪрпЖропрпНроХро┐ро▒рпЛроорпН, роЕродройро╛ро▓рпН рокро░ро┐роЪрпЛродройрпИропро┐ройрпН роЖропрпБро│рпН рооро┐роХро╡рпБроорпН роХрпБро▒рпБроХро┐ропродрпБ:

![роЪроороиро┐ро▓рпИ роЗро▓рпНро▓ро╛род CartPole](../../../../../lessons/6-Other/22-DeepRL/images/cartpole-nobalance.gif)

RL роЕро▓рпНроХро╛ро░ро┐родродрпНродро┐ройрпН роЗро▓роХрпНроХрпБ роТро░рпБ рооро╛родро┐ро░ро┐ропрпИрокрпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНро╡родрпБ - **policy** &pi; роОрой роЕро┤рпИроХрпНроХрокрпНрокроЯрпБроорпН - роЗродрпБ роХрпКроЯрпБроХрпНроХрокрпНрокроЯрпНроЯ роиро┐ро▓рпИроХрпНроХрпБ рокродро┐ро▓ро│ро┐роХрпНроХрпБроорпН роЪрпЖропро▓рпИ родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрокрпБроорпН. роиро╛роорпН policy-роР probabilistic роЖроХро╡рпБроорпН роХро░рпБродро▓ро╛роорпН, роЙродро╛ро░рогрооро╛роХ роОроирпНрод state *s* рооро▒рпНро▒рпБроорпН action *a*-роХрпНроХрпБроорпН &pi;(*a*|*s*) роОройрпНро▒ probability-роР родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрокрпБроорпН, роЕродро┐ро▓рпН state *s*-ро▓рпН *a* роЪрпЖропро▓рпН роОроЯрпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН.

## Policy Gradients роЕро▓рпНроХро╛ро░ро┐родроорпН

роТро░рпБ policy-роР рооро╛родро┐ро░ро┐ роЕроорпИрокрпНрокродро▒рпНроХро╛рой рооро┐роХ родрпЖро│ро┐ро╡ро╛рой ро╡ро┤ро┐, states-роР input роЖроХ роОроЯрпБродрпНродрпБ, роЕродро▒рпНроХро╛рой actions (роЕро▓рпНро▓родрпБ роЕройрпИродрпНродрпБ actions-роХро│ро┐ройрпН probabilities) родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрокрпБроорпН роТро░рпБ роиро░роорпНрокрпБ ро╡ро▓рпИрокрпНрокро┐ройрпНройро▓рпН (neural network) роЙро░рпБро╡ро╛роХрпНроХрпБро╡родрпБ. роЗродрпБ роТро░рпБ роЪро╛родро╛ро░рог ро╡роХрпИрокрпНрокро╛роЯрпБ (classification) рокрогро┐роХрпНроХрпБроЪрпН роЪроорооро╛роХ роЗро░рпБроХрпНроХрпБроорпН, роЖройро╛ро▓рпН роТро░рпБ роорпБроХрпНроХро┐роп ро╡ро┐родрпНродро┐ропро╛роЪроорпН - роТро╡рпНро╡рпКро░рпБ рокроЯро┐ропро┐ро▓рпБроорпН роОро╡рпНро╡ро╛ро▒рпБ роЪрпЖропро▓рпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпИ роорпБройрпНроХрпВроЯрпНроЯро┐ропрпЗ роЕро▒ро┐роп роорпБроЯро┐ропро╛родрпБ.

роЗроЩрпНроХрпБ роОрогрпНрогроорпН роОройрпНройро╡рпЖройрпНро▒ро╛ро▓рпН, роЕроирпНрод probabilities-роР роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНро╡родрпБ. рокро░ро┐роЪрпЛродройрпИропро┐ройрпН роТро╡рпНро╡рпКро░рпБ рокроЯро┐ропро┐ро▓рпБроорпН роироородрпБ роорпКродрпНрод рокро░ро┐роЪрпИ роХро╛роЯрпНроЯрпБроорпН **cumulative rewards** роОройрпНро▒ роТро░рпБ ро╡рпЖроХрпНроЯро░рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒рпЛроорпН. роорпЗро▓рпБроорпН, **reward discounting**-роР рокропройрпНрокроЯрпБродрпНродро┐, &gamma;=0.99 роОройрпНро▒ роТро░рпБ роХрпБрогроХродрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роорпБроирпНродрпИроп рокро░ро┐роЪрпБроХро│рпИ роХрпБро▒рпИроХрпНроХро┐ро▒рпЛроорпН, роЗродройро╛ро▓рпН роорпБроирпНродрпИроп рокро░ро┐роЪрпБроХро│ро┐ройрпН рокроЩрпНроХрпБ роХрпБро▒рпИроХро┐ро▒родрпБ. рокро┐ройрпНройро░рпН, роЕродро┐роХ рокро░ро┐роЪрпБроХро│рпИ ро╡ро┤роЩрпНроХрпБроорпН рокро░ро┐роЪрпЛродройрпИ рокро╛родрпИропро┐ройрпН рокроЯро┐роХро│рпИ ро╡ро▓рпБрокрпНрокроЯрпБродрпНродрпБроХро┐ро▒рпЛроорпН.

> Policy Gradient роЕро▓рпНроХро╛ро░ро┐родроорпН рокро▒рпНро▒ро┐ роорпЗро▓рпБроорпН роЕро▒ро┐ропро╡рпБроорпН рооро▒рпНро▒рпБроорпН роЕродрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроорпН роЙродро╛ро░рогродрпНродрпИ [example notebook](CartPole-RL-TF.ipynb) роЗро▓рпН рокро╛ро░рпНроХрпНроХро╡рпБроорпН.

## Actor-Critic роЕро▓рпНроХро╛ро░ро┐родроорпН

Policy Gradients роЕрогрпБроХрпБроорпБро▒рпИропро┐ройрпН роорпЗроорпНрокроЯрпНроЯ рокродро┐рокрпНрокрпБ **Actor-Critic** роОрой роЕро┤рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗродройрпН роорпБроХрпНроХро┐роп роОрогрпНрогроорпН роОройрпНройро╡рпЖройрпНро▒ро╛ро▓рпН, роиро░роорпНрокрпБ ро╡ро▓рпИрокрпНрокро┐ройрпНройро▓рпН роЗро░рогрпНроЯрпБ ро╡ро┐ро╖ропроЩрпНроХро│рпИ родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрок рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропрокрпНрокроЯрпБроорпН:

* policy, роЗродрпБ роОроирпНрод action роОроЯрпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпИ родрпАро░рпНрооро╛ройро┐роХрпНроХро┐ро▒родрпБ. роЗроирпНрод рокроХрпБродро┐ **actor** роОрой роЕро┤рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ.
* роЗроирпНрод state-ро▓рпН роиро╛роорпН рокрпЖро▒роХрпНроХрпВроЯро┐роп роорпКродрпНрод рокро░ро┐роЪро┐ройрпН роородро┐рокрпНрокрпАроЯрпБ - роЗроирпНрод рокроХрпБродро┐ **critic** роОрой роЕро┤рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ.

роТро░рпБ [GAN](../../4-ComputerVision/10-GANs/README.md) рокрпЛройрпНро▒ роТро░рпБ роХроЯрпНроЯроорпИрокрпНрокрпИ роЗродрпБ роТродрпНродро┐ро░рпБроХрпНроХро┐ро▒родрпБ, роЗродро┐ро▓рпН роЗро░рогрпНроЯрпБ ро╡ро▓рпИрокрпНрокро┐ройрпНройро▓рпНроХро│рпН роТро░рпБро╡ро░рпБроХрпНроХрпКро░рпБро╡ро░рпН роОродро┐ро░ро╛роХ рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ройрпНро▒рой. Actor-Critic рооро╛родро┐ро░ро┐ропро┐ро▓рпН, actor роиро╛роорпН роОроЯрпБроХрпНроХ ро╡рпЗрогрпНроЯро┐роп action-роР роорпБройрпНроорпКро┤ро┐роХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН critic ро╡ро┐рооро░рпНроЪройрооро╛роХ роЗро░рпБроирпНродрпБ роорпБроЯро┐ро╡рпИ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНроп роорпБропро▒рпНроЪро┐роХрпНроХро┐ро▒родрпБ. роЖройро╛ро▓рпН, роироородрпБ роЗро▓роХрпНроХрпБ роЗроирпНрод ро╡ро▓рпИрокрпНрокро┐ройрпНройро▓рпНроХро│рпИ роТро░рпБрооро┐родрпНродрооро╛роХ рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНро╡родрпБ.

рокро░ро┐роЪрпЛродройрпИропро┐ройрпН рокрпЛродрпБ роироородрпБ роорпКродрпНрод cumulative rewards рооро▒рпНро▒рпБроорпН critic роорпВро▓роорпН родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрокрокрпНрокроЯрпБроорпН роорпБроЯро┐ро╡рпБроХро│рпИ роЗро░рогрпНроЯрпИропрпБроорпН роЕро▒ро┐роирпНродро┐ро░рпБрокрпНрокродро╛ро▓рпН, роЕро╡ро▒рпНро▒ро┐ройрпН роЗроЯрпИропрпЗропро╛рой ро╡рпЗро▒рпБрокро╛роЯрпНроЯрпИ роХрпБро▒рпИроХрпНроХрпБроорпН **critic loss**-роР роЙро░рпБро╡ро╛роХрпНроХрпБро╡родрпБ роОро│ро┐родро╛роХ роЗро░рпБроХрпНроХрпБроорпН. Policy Gradient роЕро▓рпНроХро╛ро░ро┐родродрпНродро┐ро▓рпН рокропройрпНрокроЯрпБродрпНродро┐роп роЕрогрпБроХрпБроорпБро▒рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ **actor loss**-роР роХрогроХрпНроХро┐роЯро▓ро╛роорпН.

роЗроирпНрод роЕро▓рпНроХро╛ро░ро┐родроЩрпНроХро│ро┐ро▓рпН роТройрпНро▒рпИ роЗропроХрпНроХро┐роп рокро┐ро▒роХрпБ, роироородрпБ CartPole роЗро╡рпНро╡ро╛ро▒рпБ роЪрпЖропро▓рпНрокроЯрпБроорпН:

![роЪроороиро┐ро▓рпИ CartPole](../../../../../lessons/6-Other/22-DeepRL/images/cartpole-balance.gif)

## тЬНя╕П рокропро┐ро▒рпНроЪро┐роХро│рпН: Policy Gradients рооро▒рпНро▒рпБроорпН Actor-Critic RL

рокро┐ройрпНро╡ро░рпБроорпН роирпЛроЯрпНрокрпБроХрпНроХрпБроХро│ро┐ро▓рпН роЙроЩрпНроХро│рпН роХро▒рпНро▒ро▓рпИ родрпКроЯро░рпБроЩрпНроХро│рпН:

* [RL in TensorFlow](CartPole-RL-TF.ipynb)
* [RL in PyTorch](CartPole-RL-PyTorch.ipynb)

## рооро▒рпНро▒ RL рокрогро┐роХро│рпН

роЗройрпНро▒рпИроп роХро╛ро▓родрпНродро┐ро▓рпН рокро▓ройро│ро┐роХрпНроХрпБроорпН роХро▒рпНро▒ро▓рпН роТро░рпБ ро╡рпЗроХрооро╛роХ ро╡ро│ро░рпНроирпНродрпБ ро╡ро░рпБроорпН роЖро░ро╛ропрпНроЪрпНроЪро┐ родрпБро▒рпИропро╛роХ роЙро│рпНро│родрпБ. рокро▓ройро│ро┐роХрпНроХрпБроорпН роХро▒рпНро▒ро▓ро┐ройрпН роЪро┐ро▓ роЪрпБро╡ро╛ро░ро╕рпНропрооро╛рой роЙродро╛ро░рогроЩрпНроХро│рпН:

* **Atari ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпИ** ро╡ро┐ро│рпИропро╛роЯ роТро░рпБ роХрогро┐ройро┐ропрпИ роХро▒рпНро▒ро▓рпН. роЗроирпНрод рокро┐ро░роЪрпНроЪро┐ройрпИропро┐ройрпН роЪро╡ро╛ро▓ро╛рой рокроХрпБродро┐ роОройрпНройро╡рпЖройрпНро▒ро╛ро▓рпН, роОро│ро┐роп state роТро░рпБ ро╡рпЖроХрпНроЯро░ро╛роХ рокро┐ро░родро┐роиро┐родро┐родрпНродрпБро╡роорпН роЪрпЖропрпНропрокрпНрокроЯрпБро╡родро┐ро▓рпНро▓рпИ, роЖройро╛ро▓рпН роТро░рпБ screenshot - роорпЗро▓рпБроорпН роЗроирпНрод screen image-роР роТро░рпБ feature vector-роЖроХ рооро╛ро▒рпНро▒ роЕро▓рпНро▓родрпБ reward родроХро╡ро▓рпИ роОроЯрпБроХрпНроХ CNN-роР рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН. Atari ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпН Gym-ро▓рпН роХро┐роЯрпИроХрпНроХро┐ройрпНро▒рой.
* Chess рооро▒рпНро▒рпБроорпН Go рокрпЛройрпНро▒ рокро▓роХрпИ ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпИ ро╡ро┐ро│рпИропро╛роЯ роТро░рпБ роХрогро┐ройро┐ропрпИ роХро▒рпНро▒ро▓рпН. роЪроорпАрокродрпНродро┐ро▓рпН **Alpha Zero** рокрпЛройрпНро▒ state-of-the-art родро┐роЯрпНроЯроЩрпНроХро│рпН роЗро░рогрпНроЯрпБ роорпБроХро╡ро░рпНроХро│рпН роТро░рпБро╡ро░рпБроХрпНроХрпКро░рпБро╡ро░рпН роОродро┐ро░ро╛роХ ро╡ро┐ро│рпИропро╛роЯро┐, роТро╡рпНро╡рпКро░рпБ рокроЯро┐ропро┐ро▓рпБроорпН роорпЗроорпНрокроЯрпБродрпНродрпБро╡родройрпН роорпВро▓роорпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропрокрпНрокроЯрпНроЯродрпБ.
* родрпКро┤ро┐ро▓рпНродрпБро▒рпИропро┐ро▓рпН, роЪро┐роорпБро▓рпЗро╖ройро┐ро▓рпН роЗро░рпБроирпНродрпБ роХроЯрпНроЯрпБрокрпНрокро╛роЯрпНроЯрпБ роЕроорпИрокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХ RL рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроХро┐ро▒родрпБ. [Bonsai](https://azure.microsoft.com/services/project-bonsai/?WT.mc_id=academic-77998-cacaste) роОройрпБроорпН роЪрпЗро╡рпИ роЗродро▒рпНроХро╛роХро╡рпЗ ро╡роЯро┐ро╡роорпИроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ.

## роорпБроЯро┐ро╡рпБ

ро╡ро┐ро│рпИропро╛роЯрпНроЯро┐ройрпН ро╡ро┐ро░рпБроорпНрокродрпНродроХрпБроирпНрод роиро┐ро▓рпИропрпИ ро╡ро░рпИропро▒рпБроХрпНроХрпБроорпН рокро░ро┐роЪрпБ роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ ро╡ро┤роЩрпНроХрпБро╡родройрпН роорпВро▓роорпН, рооро▒рпНро▒рпБроорпН родрпЗроЯро▓рпН роЗроЯродрпНродрпИ рокрпБродрпНродро┐роЪро╛ро▓ро┐ропро╛роХ роЖро░ро╛ропрпНро╡родро▒рпНроХро╛рой ро╡ро╛ропрпНрокрпНрокрпИ ро╡ро┤роЩрпНроХрпБро╡родройрпН роорпВро▓роорпН, роиро▓рпНро▓ роорпБроЯро┐ро╡рпБроХро│рпИ роЕроЯрпИроп роорпБроХро╡ро░рпНроХро│рпИ рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНроп роОро╡рпНро╡ро╛ро▒рпБ роХро▒рпНро▒рпБроХрпНроХрпКрогрпНроЯрпЛроорпН роОройрпНрокродрпИ роЗрокрпНрокрпЛродрпБ роЕро▒ро┐роирпНродрпБро│рпНро│рпЛроорпН. роЗро░рогрпНроЯрпБ роЕро▓рпНроХро╛ро░ро┐родроЩрпНроХро│рпИ ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роорпБропро▒рпНроЪро┐ роЪрпЖропрпНродрпБ, роХрпБро▒рпБроХро┐роп роХро╛ро▓родрпНродро┐ро▓рпН роиро▓рпНро▓ роорпБроЯро┐ро╡рпИ роЕроЯрпИроирпНродрпЛроорпН. роЗро░рпБрокрпНрокро┐ройрпБроорпН, роЗродрпБ RL-ро▓рпН роЙроЩрпНроХро│рпН рокропрогродрпНродро┐ройрпН родрпКроЯроХрпНроХроорпЗ, роорпЗро▓рпБроорпН роирпАроЩрпНроХро│рпН роЖро┤рооро╛роХ роХро▒рпНро▒рпБроХрпНроХрпКро│рпНро│ ро╡ро┐ро░рпБроорпНрокро┐ройро╛ро▓рпН родройро┐ рокро╛роЯроирпЖро▒ро┐ропрпИ роОроЯрпБродрпНродрпБроХрпН роХрпКро│рпНро│ ро╡рпЗрогрпНроЯрпБроорпН.

## ЁЯЪА роЪро╡ро╛ро▓рпН

'рооро▒рпНро▒ RL рокрогро┐роХро│рпН' рокро┐ро░ро┐ро╡ро┐ро▓рпН рокроЯрпНроЯро┐ропро▓ро┐роЯрокрпНрокроЯрпНроЯ рокропройрпНрокро╛роЯрпБроХро│рпИ роЖро░ро╛ропрпНроирпНродрпБ, роТройрпНро▒рпИ роЪрпЖропро▓рпНрокроЯрпБродрпНрод роорпБропро▒рпНроЪро┐роХрпНроХро╡рпБроорпН!

## [рокро┐ройрпН-ро╡роХрпБрокрпНрокрпБ ро╡ро┐ройро╛роЯро┐ ро╡ро┐ройро╛](https://ff-quizzes.netlify.app/en/ai/quiz/44)

## роородро┐рокрпНрокрпАроЯрпБ рооро▒рпНро▒рпБроорпН роЪрпБроп роХро▒рпНро▒ро▓рпН

роироородрпБ [Machine Learning for Beginners Curriculum](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/README.md) роЗро▓рпН рокро╛ро░роорпНрокро░ро┐роп рокро▓ройро│ро┐роХрпНроХрпБроорпН роХро▒рпНро▒ро▓рпН рокро▒рпНро▒ро┐ роорпЗро▓рпБроорпН роЕро▒ро┐роХ.

Super Mario ро╡ро┐ро│рпИропро╛роЯ роТро░рпБ роХрогро┐ройро┐ роОрокрпНрокроЯро┐ роХро▒рпНро▒рпБроХрпНроХрпКро│рпНро│ роорпБроЯро┐ропрпБроорпН роОройрпНрокродрпИрокрпН рокро▒рпНро▒ро┐ рокрпЗроЪрпБроорпН [роЗроирпНрод роЪро┐ро▒роирпНрод ро╡рпАроЯро┐ропрпЛ](https://www.youtube.com/watch?v=qv6UVOQ0F44) рокро╛ро░рпБроЩрпНроХро│рпН.

## рокрогро┐роХрпНроХроЯрпНроЯро│рпИ: [Train a Mountain Car](lab/README.md)

роЗроирпНрод рокрогро┐роХрпНроХроЯрпНроЯро│рпИропро┐ройрпН рокрпЛродрпБ роЙроЩрпНроХро│рпН роЗро▓роХрпНроХрпБ [Mountain Car](https://www.gymlibrary.ml/environments/classic_control/mountain_car/) роОройрпБроорпН Gym роЪрпВро┤ро▓рпИ рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНро╡родро╛роХ роЗро░рпБроХрпНроХрпБроорпН.

---

**роХрпБро▒ро┐рокрпНрокрпБ**:  
роЗроирпНрод роЖро╡рогроорпН [Co-op Translator](https://github.com/Azure/co-op-translator) роОройрпНро▒ AI роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ роЪрпЗро╡рпИропрпИ рокропройрпНрокроЯрпБродрпНродро┐ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роОроЩрпНроХро│рпН роирпЛроХрпНроХроорпН родрпБро▓рпНро▓ро┐ропрооро╛роХ роЗро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпБродро╛ройрпН, роЖройро╛ро▓рпН родро╛ройро┐ропроЩрпНроХро┐ роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБроХро│ро┐ро▓рпН рокро┐ро┤рпИроХро│рпН роЕро▓рпНро▓родрпБ родрпБро▓рпНро▓ро┐ропрооро┐ройрпНроорпИроХро│рпН роЗро░рпБроХрпНроХроХрпНроХрпВроЯрпБроорпН роОройрпНрокродрпИ родропро╡рпБроЪрпЖропрпНродрпБ роХро╡ройродрпНродро┐ро▓рпН роХрпКро│рпНро│ро╡рпБроорпН. роЕродройрпН родро╛ропрпНроорпКро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роорпВро▓ роЖро╡рогроорпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖродро╛ро░рооро╛роХ роХро░рпБродрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роорпБроХрпНроХро┐ропрооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, родрпКро┤ро┐ро▓рпНроорпБро▒рпИ рооройро┐род роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗроирпНрод роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН роОроирпНрод родро╡ро▒ро╛рой рокрпБро░ро┐родро▓рпНроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпБроХрпНроХрпБ роиро╛роЩрпНроХро│рпН рокрпКро▒рпБрокрпНрокро▓рпНро▓.