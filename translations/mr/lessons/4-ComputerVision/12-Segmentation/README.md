# рд╡рд┐рднрд╛рдЧрдгреА

рдЖрдореНрд╣реА рдпрд╛рдкреВрд░реНрд╡реА рдСрдмреНрдЬреЗрдХреНрдЯ рдбрд┐рдЯреЗрдХреНрд╢рдирдмрджреНрджрд▓ рд╢рд┐рдХрд▓реЗ рдЖрд╣реЗ, рдЬреНрдпрд╛рдореБрд│реЗ рдЖрдореНрд╣рд╛рд▓рд╛ рдкреНрд░рддрд┐рдореЗрдордзреНрдпреЗ рд╡рд╕реНрддреВрдВрдЪреЗ рд╕реНрдерд╛рди рд╢реЛрдзрддрд╛ рдпреЗрддреЗ рдЖрдгрд┐ рддреНрдпрд╛рдВрдЪреНрдпрд╛ *bounding boxes* рдЪреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рддрд╛ рдпреЗрддреЗ. рдкрд░рдВрддреБ, рдХрд╛рд╣реА рдХрд╛рд░реНрдпрд╛рдВрд╕рд╛рдареА рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдлрдХреНрдд bounding boxes рдкреБрд░реЗрд╕реЗ рдирд╕реВрди рд╡рд╕реНрддреВрдВрдЪреЗ рдЕрдзрд┐рдХ рдЕрдЪреВрдХ рд╕реНрдерд╛рди рдЖрд╡рд╢реНрдпрдХ рдЕрд╕рддреЗ. рдпрд╛ рдХрд╛рд░реНрдпрд╛рд▓рд╛ **рд╡рд┐рднрд╛рдЧрдгреА** рдореНрд╣рдгрддрд╛рдд.

## [рдкреВрд░реНрд╡-рд╡реНрдпрд╛рдЦреНрдпрд╛рди рдкреНрд░рд╢реНрдирдордВрдЬреВрд╖рд╛](https://ff-quizzes.netlify.app/en/ai/quiz/23)

рд╡рд┐рднрд╛рдЧрдгреАрд▓рд╛ **рдкрд┐рдХреНрд╕реЗрд▓ рд╡рд░реНрдЧреАрдХрд░рдг** рдореНрд╣рдгреВрди рдкрд╛рд╣рд┐рд▓реЗ рдЬрд╛рдК рд╢рдХрддреЗ, рдЬрд┐рдереЗ рдкреНрд░рддрд┐рдореЗрддреАрд▓ **рдкреНрд░рддреНрдпреЗрдХ** рдкрд┐рдХреНрд╕реЗрд▓рд╕рд╛рдареА рддреНрдпрд╛рдЪрд╛ рд╡рд░реНрдЧ (*background* рд╣рд╛ рд╡рд░реНрдЧрд╛рдВрдкреИрдХреА рдПрдХ рдЖрд╣реЗ) рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ. рд╡рд┐рднрд╛рдЧрдгреАрд╕рд╛рдареА рджреЛрди рдореБрдЦреНрдп рдЕрд▓реНрдЧреЛрд░рд┐рджрдо рдЖрд╣реЗрдд:

* **рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рднрд╛рдЧрдгреА (Semantic segmentation)** рдлрдХреНрдд рдкрд┐рдХреНрд╕реЗрд▓рдЪрд╛ рд╡рд░реНрдЧ рд╕рд╛рдВрдЧрддреЗ рдЖрдгрд┐ рд╕рдорд╛рди рд╡рд░реНрдЧрд╛рддреАрд▓ рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рд╡рд╕реНрддреВрдВрдордзреНрдпреЗ рдлрд░рдХ рдХрд░рдд рдирд╛рд╣реА.
* **рдЗрдиреНрд╕реНрдЯрдиреНрд╕ рд╡рд┐рднрд╛рдЧрдгреА (Instance segmentation)** рд╡рд░реНрдЧрд╛рдВрдирд╛ рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рдВрдордзреНрдпреЗ рд╡рд┐рднрд╛рдЧрддреЗ.

рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, рдЗрдиреНрд╕реНрдЯрдиреНрд╕ рд╡рд┐рднрд╛рдЧрдгреАрд╕рд╛рдареА рдпрд╛ рдореЗрдВрдвреНрдпрд╛ рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рд╡рд╕реНрддреВ рдЖрд╣реЗрдд, рдкрд░рдВрддреБ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рднрд╛рдЧрдгреАрд╕рд╛рдареА рд╕рд░реНрд╡ рдореЗрдВрдвреНрдпрд╛ рдПрдХрд╛рдЪ рд╡рд░реНрдЧрд╛рдиреЗ рджрд░реНрд╢рд╡рд┐рд▓реНрдпрд╛ рдЬрд╛рддрд╛рдд.

<img src="../../../../../translated_images/mr/instance_vs_semantic.eee9812bebf8cd45.webp" width="50%">

> рдкреНрд░рддрд┐рдорд╛ [рдпрд╛ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯрдордзреВрди](https://nirmalamurali.medium.com/image-classification-vs-semantic-segmentation-vs-instance-segmentation-625c33a08d50)

рд╡рд┐рднрд╛рдЧрдгреАрд╕рд╛рдареА рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рдиреНрдпреВрд░рд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдЖрд╣реЗрдд, рдкрд░рдВрддреБ рддреНрдпрд╛рдВрдЪреА рд░рдЪрдирд╛ рд╕рд╛рд░рдЦреАрдЪ рдЕрд╕рддреЗ. рдПрдХрд╛ рдкреНрд░рдХрд╛рд░реЗ, рд╣реЗ рддреБрдореНрд╣реА рдпрд╛рдкреВрд░реНрд╡реА рд╢рд┐рдХрд▓реЗрд▓реНрдпрд╛ рдСрдЯреЛрдПрдиреНрдХреЛрдбрд░рдкреНрд░рдорд╛рдгреЗрдЪ рдЖрд╣реЗ, рдкрд░рдВрддреБ рдореВрд│ рдкреНрд░рддрд┐рдорд╛ рдбреАрдХреЛрдб рдХрд░рдгреНрдпрд╛рдРрд╡рдЬреА, рдЖрдкрд▓реЗ рд▓рдХреНрд╖реНрдп **рдорд╛рд╕реНрдХ** рдбреАрдХреЛрдб рдХрд░рдгреЗ рдЖрд╣реЗ. рддреНрдпрд╛рдореБрд│реЗ, рд╡рд┐рднрд╛рдЧрдгреА рдиреЗрдЯрд╡рд░реНрдХрдордзреНрдпреЗ рдЦрд╛рд▓реАрд▓ рднрд╛рдЧ рдЕрд╕рддрд╛рдд:

* **рдПрдиреНрдХреЛрдбрд░** рдЗрдирдкреБрдЯ рдкреНрд░рддрд┐рдореЗрддреВрди рд╡реИрд╢рд┐рд╖реНрдЯреНрдпреЗ рдХрд╛рдврддреЛ.
* **рдбреАрдХреЛрдбрд░** рддреНрдпрд╛ рд╡реИрд╢рд┐рд╖реНрдЯреНрдпрд╛рдВрдирд╛ **рдорд╛рд╕реНрдХ рдкреНрд░рддрд┐рдореЗрдордзреНрдпреЗ** рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд░рддреЛ, рдЬреНрдпрд╛рдЪрд╛ рдЖрдХрд╛рд░ рдЖрдгрд┐ рдЪреЕрдиреЗрд▓рдЪреА рд╕рдВрдЦреНрдпрд╛ рд╡рд░реНрдЧрд╛рдВрдЪреНрдпрд╛ рд╕рдВрдЦреНрдпреЗрд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдЕрд╕рддреЗ.

<img src="../../../../../translated_images/mr/segm.92442f2cb42ff4fa.webp" width="80%">

> рдкреНрд░рддрд┐рдорд╛ [рдпрд╛ рдкреНрд░рдХрд╛рд╢рдирд╛рддреВрди](https://arxiv.org/pdf/2001.05566.pdf)

рд╡рд┐рднрд╛рдЧрдгреАрд╕рд╛рдареА рд╡рд╛рдкрд░рд▓реНрдпрд╛ рдЬрд╛рдгрд╛рд▒реНрдпрд╛ рд▓реЙрд╕ рдлрдВрдХреНрд╢рдирдЪрд╛ рд╡рд┐рд╢реЗрд╖ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ. рдкрд╛рд░рдВрдкрд░рд┐рдХ рдСрдЯреЛрдПрдиреНрдХреЛрдбрд░ рд╡рд╛рдкрд░рддрд╛рдирд╛, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рджреЛрди рдкреНрд░рддрд┐рдорд╛рдВрдордзреАрд▓ рд╕рдорд╛рдирддрд╛ рдореЛрдЬрд╛рд╡реА рд▓рд╛рдЧрддреЗ рдЖрдгрд┐ рддреНрдпрд╛рд╕рд╛рдареА рдЖрдкрдг mean square error (MSE) рд╡рд╛рдкрд░реВ рд╢рдХрддреЛ. рд╡рд┐рднрд╛рдЧрдгреАрдордзреНрдпреЗ, рд▓рдХреНрд╖реНрдп рдорд╛рд╕реНрдХ рдкреНрд░рддрд┐рдореЗрддреАрд▓ рдкреНрд░рддреНрдпреЗрдХ рдкрд┐рдХреНрд╕реЗрд▓ рд╡рд░реНрдЧ рдХреНрд░рдорд╛рдВрдХрд╛рдЪреЗ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддреЗ (рддрд┐рд╕рд▒реНрдпрд╛ рдкрд░рд┐рдорд╛рдгрд╛рд╡рд░ рдПрдХ-рд╣реЙрдЯ-рдПрдиреНрдХреЛрдб рдХреЗрд▓реЗрд▓реЗ), рддреНрдпрд╛рдореБрд│реЗ рд╡рд░реНрдЧреАрдХрд░рдгрд╛рд╕рд╛рдареА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд▓реЙрд╕ рдлрдВрдХреНрд╢рдиреНрд╕ рд╡рд╛рдкрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ - рдХреНрд░реЙрд╕-рдПрдВрдЯреНрд░реЙрдкреА рд▓реЙрд╕, рд╕рд░реНрд╡ рдкрд┐рдХреНрд╕реЗрд▓реНрд╕рд╡рд░ рд╕рд░рд╛рд╕рд░реА рдШреЗрддрд▓реЗрд▓реЗ. рдЬрд░ рдорд╛рд╕реНрдХ рдмрд╛рдпрдирд░реА рдЕрд╕реЗрд▓ - **рдмрд╛рдпрдирд░реА рдХреНрд░реЙрд╕-рдПрдВрдЯреНрд░реЙрдкреА рд▓реЙрд╕** (BCE) рд╡рд╛рдкрд░рд▓рд╛ рдЬрд╛рддреЛ.

> тЬЕ рдПрдХ-рд╣реЙрдЯ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд╣реА рд╡рд░реНрдЧ рд▓реЗрдмрд▓рд▓рд╛ рд╡рд░реНрдЧрд╛рдВрдЪреНрдпрд╛ рд╕рдВрдЦреНрдпреЗрдЗрддрдХреНрдпрд╛ рд▓рд╛рдВрдмреАрдЪреНрдпрд╛ рд╡реНрд╣реЗрдХреНрдЯрд░рдордзреНрдпреЗ рдПрдиреНрдХреЛрдб рдХрд░рдгреНрдпрд╛рдЪреА рдкрджреНрдзрдд рдЖрд╣реЗ. [рдпрд╛ рд▓реЗрдЦрд╛рдд](https://datagy.io/sklearn-one-hot-encode/) рдпрд╛ рддрдВрддреНрд░рд╛рдмрджреНрджрд▓ рдЕрдзрд┐рдХ рдЬрд╛рдгреВрди рдШреНрдпрд╛.

## рд╡реИрджреНрдпрдХреАрдп рдкреНрд░рддрд┐рдорд╛рдВрд╕рд╛рдареА рд╡рд┐рднрд╛рдЧрдгреА

рдпрд╛ рдзрдбреНрдпрд╛рдд, рдЖрдкрдг рд╡рд┐рднрд╛рдЧрдгреА рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд рдкрд╛рд╣реВ, рдЬрд┐рдереЗ рдиреЗрдЯрд╡рд░реНрдХрд▓рд╛ рд╡реИрджреНрдпрдХреАрдп рдкреНрд░рддрд┐рдорд╛рдВрд╡рд░ рдорд╛рдирд╡реА рдиреЗрд╡реА (рдореНрд╣рдгрдЬреЗрдЪ рдореЛрд▓реНрд╕) рдУрд│рдЦрдгреНрдпрд╛рд╕рд╛рдареА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджрд┐рд▓реЗ рдЬрд╛рдИрд▓. рдЖрдореНрд╣реА <a href="https://www.fc.up.pt/addi/ph2%20database.html">PH<sup>2</sup> рдбреЗрдЯрд╛рдмреЗрд╕</a> рд╡рд╛рдкрд░рдгрд╛рд░ рдЖрд╣реЛрдд, рдЬреЛ рдбрд░реНрдореЛрд╕реНрдХреЛрдкреА рдкреНрд░рддрд┐рдорд╛рдВрдЪрд╛ рд╕реНрд░реЛрдд рдЖрд╣реЗ. рдпрд╛ рдбреЗрдЯрд╛рд╕реЗрдЯрдордзреНрдпреЗ рддреАрди рд╡рд░реНрдЧрд╛рдВрдЪреНрдпрд╛ 200 рдкреНрд░рддрд┐рдорд╛ рдЖрд╣реЗрдд: рд╕рд╛рдорд╛рдиреНрдп рдиреЗрд╡реНрд╣рд╕, рдЕрд╕рд╛рдорд╛рдиреНрдп рдиреЗрд╡реНрд╣рд╕, рдЖрдгрд┐ рдореЗрд▓рд╛рдиреЛрдорд╛. рд╕рд░реНрд╡ рдкреНрд░рддрд┐рдорд╛рдВрдордзреНрдпреЗ рдиреЗрд╡реНрд╣рд╕рдЪреА рд░реВрдкрд░реЗрд╖рд╛ рдЕрд╕рд▓реЗрд▓рд╛ **рдорд╛рд╕реНрдХ** рджреЗрдЦреАрд▓ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдЖрд╣реЗ.

> тЬЕ рд╣реА рддрдВрддреНрд░ рд╡реИрджреНрдпрдХреАрдп рдкреНрд░рддрд┐рдорд╛рдВрд╕рд╛рдареА рд╡рд┐рд╢реЗрд╖рддрдГ рдпреЛрдЧреНрдп рдЖрд╣реЗ, рдкрд░рдВрддреБ рддреБрдореНрд╣реА рдЗрддрд░ рдХреЛрдгрддреНрдпрд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ-рдЬрдЧрд╛рддреАрд▓ рдЕрдиреБрдкреНрд░рдпреЛрдЧрд╛рдВрдЪреА рдХрд▓реНрдкрдирд╛ рдХрд░реВ рд╢рдХрддрд╛?

<img alt="navi" src="../../../../../translated_images/mr/navi.2f20b727910110ea.webp"/>

> рдкреНрд░рддрд┐рдорд╛ PH<sup>2</sup> рдбреЗрдЯрд╛рдмреЗрд╕рдордзреВрди

рдЖрдореНрд╣реА рдореЙрдбреЗрд▓рд▓рд╛ рддреНрдпрд╛рдЪреНрдпрд╛ рдкрд╛рд░реНрд╢реНрд╡рднреВрдореАрдкрд╛рд╕реВрди рдХреЛрдгрддрд╛рд╣реА рдиреЗрд╡реНрд╣рд╕ рд╡рд┐рднрд╛рдЧрдгреНрдпрд╛рд╕рд╛рдареА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджреЗрдК.

## тЬНя╕П рд╕рд░рд╛рд╡: рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рднрд╛рдЧрдгреА

рдЦрд╛рд▓реАрд▓ рдиреЛрдЯрдмреБрдХ рдЙрдШрдбрд╛, рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рднрд╛рдЧрдгреА рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░рдмрджреНрджрд▓ рдЕрдзрд┐рдХ рдЬрд╛рдгреВрди рдШреНрдпрд╛, рддреНрдпрд╛рдВрдЪреНрдпрд╛рд╕реЛрдмрдд рдХрд╛рдо рдХрд░рдгреНрдпрд╛рдЪрд╛ рд╕рд░рд╛рд╡ рдХрд░рд╛ рдЖрдгрд┐ рддреНрдпрд╛рдВрдирд╛ рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд рдкрд╛рд╣рд╛.

* [рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рднрд╛рдЧрдгреА PyTorch](SemanticSegmentationPytorch.ipynb)
* [рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рднрд╛рдЧрдгреА TensorFlow](SemanticSegmentationTF.ipynb)

## [рд╡реНрдпрд╛рдЦреНрдпрд╛рдирд╛рдирдВрддрд░рдЪреА рдкреНрд░рд╢реНрдирдордВрдЬреВрд╖рд╛](https://ff-quizzes.netlify.app/en/ai/quiz/24)

## рдирд┐рд╖реНрдХрд░реНрд╖

рд╡рд┐рднрд╛рдЧрдгреА рд╣реА рдкреНрд░рддрд┐рдорд╛ рд╡рд░реНрдЧреАрдХрд░рдгрд╛рд╕рд╛рдареА рдПрдХ рдЕрддреНрдпрдВрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рддрдВрддреНрд░ рдЖрд╣реЗ, рдЬреА bounding boxes рдЪреНрдпрд╛ рдкрд▓реАрдХрдбреЗ рдЬрд╛рдКрди рдкрд┐рдХреНрд╕реЗрд▓-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рдХрд░рддреЗ. рд╣реЗ рд╡реИрджреНрдпрдХреАрдп рдкреНрд░рддрд┐рдорд╛рдВрд╕рд╣ рдЗрддрд░ рдЕрдиреЗрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧрд╛рдВрдордзреНрдпреЗ рд╡рд╛рдкрд░рд▓реЗ рдЬрд╛рддреЗ.

## ЁЯЪА рдЖрд╡реНрд╣рд╛рди

рд╢рд░реАрд░ рд╡рд┐рднрд╛рдЧрдгреА рд╣реА рд▓реЛрдХрд╛рдВрдЪреНрдпрд╛ рдкреНрд░рддрд┐рдорд╛рдВрд╕рд╣ рдЖрдкрдг рдХрд░реВ рд╢рдХрдгрд╛рд▒реНрдпрд╛ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдпрд╛рдВрдкреИрдХреА рдПрдХ рдЖрд╣реЗ. рдЖрдгрдЦреА рдорд╣рддреНрддреНрд╡рд╛рдЪреА рдХрд╛рд░реНрдпреЗ рдореНрд╣рдгрдЬреЗ **рд╕реНрдирд╛рдпреВ рд╢реЛрдзрдгреЗ** рдЖрдгрд┐ **рд╕реНрдерд┐рддреА рд╢реЛрдзрдгреЗ**. [OpenPose](https://github.com/CMU-Perceptual-Computing-Lab/openpose) рд▓рд╛рдпрдмреНрд░рд░реА рд╡рд╛рдкрд░реВрди рд╕реНрдерд┐рддреА рд╢реЛрдзрдгреЗ рдХрд╕реЗ рд╡рд╛рдкрд░рд▓реЗ рдЬрд╛рдК рд╢рдХрддреЗ рддреЗ рдкрд╛рд╣рд╛.

## рдкреБрдирд░рд╛рд╡рд▓реЛрдХрди рдЖрдгрд┐ рд╕реНрд╡-рдЕрднреНрдпрд╛рд╕

[рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛ рд▓реЗрдЦ](https://wikipedia.org/wiki/Image_segmentation) рдпрд╛ рддрдВрддреНрд░рд╛рдЪреНрдпрд╛ рд╡рд┐рд╡рд┐рдз рдЕрдиреБрдкреНрд░рдпреЛрдЧрд╛рдВрдЪреЗ рдЪрд╛рдВрдЧрд▓реЗ рд╡рд┐рд╣рдВрдЧрд╛рд╡рд▓реЛрдХрди рджреЗрддреЗ. рдпрд╛ рдХреНрд╖реЗрддреНрд░рд╛рддреАрд▓ рдЗрдиреНрд╕реНрдЯрдиреНрд╕ рд╡рд┐рднрд╛рдЧрдгреА рдЖрдгрд┐ рдкреЕрдиреЛрдкреНрдЯрд┐рдХ рд╡рд┐рднрд╛рдЧрдгреАрдЪреНрдпрд╛ рдЙрдкрдбреЛрдореЗрдирдмрджреНрджрд▓ рд╕реНрд╡рддрдГ рдЕрдзрд┐рдХ рдЬрд╛рдгреВрди рдШреНрдпрд╛.

## [рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ](lab/README.md)

рдпрд╛ рдкреНрд░рдпреЛрдЧрд╢рд╛рд│реЗрдд, [Segmentation Full Body MADS Dataset](https://www.kaggle.com/datasets/tapakah68/segmentation-full-body-mads-dataset) рд╡рд╛рдкрд░реВрди **рдорд╛рдирд╡реА рд╢рд░реАрд░ рд╡рд┐рднрд╛рдЧрдгреА** рдХрд░рдгреНрдпрд╛рдЪрд╛ рдкреНрд░рдпрддреНрди рдХрд░рд╛.

---

