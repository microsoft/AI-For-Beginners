# рдзреНрдпрд╛рди рддрдВрддреНрд░ рдФрд░ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░

## [рдкреНрд░реА-рд▓реЗрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/118)

NLP рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рдорд╕реНрдпрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ **рдорд╢реАрди рдЕрдиреБрд╡рд╛рдж**, рдЬреЛ рдРрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдп рд╣реИ рдЬреИрд╕реЗ рдХрд┐ Google Translateред рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ, рд╣рдо рдорд╢реАрди рдЕрдиреБрд╡рд╛рдж рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ, рдпрд╛, рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ, рдХрд┐рд╕реА рднреА *рдХреНрд░рдо-рд╕реЗ-рдХреНрд░рдо* рдХрд╛рд░реНрдп рдкрд░ (рдЬрд┐рд╕реЗ **рд╡рд╛рдХреНрдп рдЯреНрд░рд╛рдВрд╕рдбрдХреНрд╕рди** рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ)ред

RNNs рдХреЗ рд╕рд╛рде, рдХреНрд░рдо-рд╕реЗ-рдХреНрд░рдо рдХреЛ рджреЛ рдЖрд╡рд░реНрддреА рдиреЗрдЯрд╡рд░реНрдХ рджреНрд╡рд╛рд░рд╛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ, **рдПрдиреНрдХреЛрдбрд░**, рдПрдХ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рдПрдХ рдЫрд┐рдкреА рд╣реБрдИ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕рдВрдХреБрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рджреВрд╕рд░рд╛ рдиреЗрдЯрд╡рд░реНрдХ, **рдбрд┐рдХреЛрдбрд░**, рдЗрд╕ рдЫрд┐рдкреА рд╣реБрдИ рд╕реНрдерд┐рддрд┐ рдХреЛ рдПрдХ рдЕрдиреБрд╡рд╛рджрд┐рдд рдкрд░рд┐рдгрд╛рдо рдореЗрдВ рдЕрдирд░реЛрд▓ рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде рдХреБрдЫ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реИрдВ:

* рдПрдиреНрдХреЛрдбрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдЕрдВрддрд┐рдо рд╕реНрдерд┐рддрд┐ рдПрдХ рд╡рд╛рдХреНрдп рдХреА рд╢реБрд░реБрдЖрдд рдХреЛ рдпрд╛рдж рд░рдЦрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ рдорд╣рд╕реВрд╕ рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд▓рдВрдмреЗ рд╡рд╛рдХреНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдореЙрдбрд▓ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдЦрд░рд╛рдм рд╣реЛрддреА рд╣реИред
* рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рд╕рднреА рд╢рдмреНрджреЛрдВ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдкрд░ рд╕рдорд╛рди рдкреНрд░рднрд╛рд╡ рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдореЗрдВ, рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╢рдмреНрдж рдЕрдХреНрд╕рд░ рдЕрдиреНрдп рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдиреБрдХреНрд░рдорд┐рдХ рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рддреЗ рд╣реИрдВред

**рдзреНрдпрд╛рди рддрдВрддреНрд░** рдкреНрд░рддреНрдпреЗрдХ рдЗрдирдкреБрдЯ рд╡реЗрдХреНрдЯрд░ рдХреЗ рд╕рдВрджрд░реНрднрд╛рддреНрдордХ рдкреНрд░рднрд╛рд╡ рдХреЛ RNN рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЖрдЙрдЯрдкреБрдЯ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдкрд░ рд╡рдЬрди рджреЗрдиреЗ рдХрд╛ рдПрдХ рд╕рд╛рдзрди рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЗрдирдкреБрдЯ RNN рдФрд░ рдЖрдЙрдЯрдкреБрдЯ RNN рдХреЗ рдордзреНрдпрд╡рд░реНрддреА рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рдмреАрдЪ рд╢реЙрд░реНрдЯрдХрдЯ рдмрдирд╛рдирд╛ рд╣реИред рдЗрд╕ рддрд░рд╣, рдЬрдм рдЖрдЙрдЯрдкреБрдЯ рдкреНрд░рддреАрдХ y<sub>t</sub> рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рд╕рднреА рдЗрдирдкреБрдЯ рдЫрд┐рдкреА рд╣реБрдИ рд╕реНрдерд┐рддрд┐рдпреЛрдВ h<sub>i</sub> рдХреЛ рд╡рд┐рднрд┐рдиреНрди рд╡рдЬрди рдЧреБрдгрд╛рдВрдХ ╬▒<sub>t,i</sub> рдХреЗ рд╕рд╛рде рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реИрдВред

![рдПрдХ рдПрдиреНрдХреЛрдбрд░/рдбрд┐рдХреЛрдбрд░ рдореЙрдбрд▓ рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рд╡рд╛рд▓реА рдЫрд╡рд┐ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЬреЛрдбрд╝рд╛рддреНрдордХ рдзреНрдпрд╛рди рдкрд░рдд рд╣реИ](../../../../../translated_images/encoder-decoder-attention.7a726296894fb567aa2898c94b17b3289087f6705c11907df8301df9e5eeb3de.hi.png)

> рдПрдиреНрдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ рдореЙрдбрд▓ рдЬрд┐рд╕рдореЗрдВ рдЬреЛрдбрд╝рд╛рддреНрдордХ рдзреНрдпрд╛рди рддрдВрддреНрд░ рд╣реИ [Bahdanau et al., 2015](https://arxiv.org/pdf/1409.0473.pdf) рд╕реЗ, [рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://lilianweng.github.io/lil-log/2018/06/24/attention-attention.html) рд╕реЗ рдЙрджреНрдзреГрддред

рдзреНрдпрд╛рди рдореИрдЯреНрд░рд┐рдХреНрд╕ {╬▒<sub>i,j</sub>} рдпрд╣ рджрд░реНрд╢рд╛рдПрдЧрд╛ рдХрд┐ рдХреБрдЫ рдЗрдирдкреБрдЯ рд╢рдмреНрджреЛрдВ рдХрд╛ рдПрдХ рджрд┐рдП рдЧрдП рд╢рдмреНрдж рдХреЗ рдЙрддреНрдкрд╛рджрди рдореЗрдВ рдХреНрдпрд╛ рдпреЛрдЧрджрд╛рди рд╣реИред рдиреАрдЪреЗ рдПрдХ рдРрд╕реЗ рдореИрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

![RNNsearch-50 рджреНрд╡рд╛рд░рд╛ рдкрд╛рдП рдЧрдП рдПрдХ рдирдореВрдирд╛ рд╕рдВрд░реЗрдЦрдг рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рд╡рд╛рд▓реА рдЫрд╡рд┐, Bahdanau - arviz.org рд╕реЗ рд▓реА рдЧрдИ](../../../../../translated_images/bahdanau-fig3.09ba2d37f202a6af11de6c82d2d197830ba5f4528d9ea430eb65fd3a75065973.hi.png)

> рдЪрд┐рддреНрд░ [Bahdanau et al., 2015](https://arxiv.org/pdf/1409.0473.pdf) рд╕реЗ (рдЪрд┐рддреНрд░ 3)

рдзреНрдпрд╛рди рддрдВрддреНрд░ рд╡рд░реНрддрдорд╛рди рдпрд╛ рд▓рдЧрднрдЧ рд╡рд░реНрддрдорд╛рди рд░рд╛рдЬреНрдп рдореЗрдВ NLP рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдореЙрдбрд▓ рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрд╣реБрдд рдмрдврд╝ рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ RNNs рдХреЗ рд╕рд╛рде рд╕реНрдХреЗрд▓рд┐рдВрдЧ рдХреА рд╕рдорд╕реНрдпрд╛рдПрдВ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВред RNNs рдХреЗ рд╕реНрдХреЗрд▓рд┐рдВрдЧ рдХрд╛ рдПрдХ рдкреНрд░рдореБрдЦ рдмрд╛рдзрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдореЙрдбрд▓реЛрдВ рдХреА рдЖрд╡рд░реНрддреА рдкреНрд░рдХреГрддрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛ рдмреИрдЪ рдФрд░ рд╕рдорд╛рдирд╛рдВрддрд░ рдмрдирд╛рдирд╛ рдЪреБрдиреМрддреАрдкреВрд░реНрдг рдмрдирд╛рддреА рд╣реИред рдПрдХ RNN рдореЗрдВ рдЕрдиреБрдХреНрд░рдо рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреЛ рдЕрдиреБрдХреНрд░рдорд┐рдХ рдХреНрд░рдо рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![рдзреНрдпрд╛рди рдХреЗ рд╕рд╛рде рдПрдиреНрдХреЛрдбрд░ рдбрд┐рдХреЛрдбрд░](../../../../../lessons/5-NLP/18-Transformers/images/EncDecAttention.gif)

> рдЪрд┐рддреНрд░ [Google рдХреЗ рдмреНрд▓реЙрдЧ](https://research.googleblog.com/2016/09/a-neural-network-for-machine.html) рд╕реЗ

рдзреНрдпрд╛рди рддрдВрддреНрд░реЛрдВ рдХреЛ рдЕрдкрдирд╛рдиреЗ рдФрд░ рдЗрд╕ рдмрд╛рдзрд╛ рдХреЗ рд╕рдВрдпреЛрдЬрди рдиреЗ рдЖрдЬ рдХреЗ рдЬреНрдЮрд╛рдд рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдЯреЗрдЯ рдСрдл рдж рдЖрд░реНрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓реНрд╕ рдЬреИрд╕реЗ BERT рд╕реЗ Open-GPT3 рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреА рдУрд░ рдЕрдЧреНрд░рд╕рд░ рдХрд┐рдпрд╛ред

## рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓

рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░реЛрдВ рдХреЗ рдкреАрдЫреЗ рдХрд╛ рдПрдХ рдореБрдЦреНрдп рд╡рд┐рдЪрд╛рд░ RNNs рдХреА рдЕрдиреБрдХреНрд░рдорд┐рдХ рдкреНрд░рдХреГрддрд┐ рд╕реЗ рдмрдЪрдирд╛ рдФрд░ рдПрдХ рдРрд╕рд╛ рдореЙрдбрд▓ рдмрдирд╛рдирд╛ рд╣реИ рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рд╕рдорд╛рдирд╛рдВрддрд░ рд╣реЛ рд╕рдХреЗред рдпрд╣ рджреЛ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

* рд╕реНрдерд┐рддрд┐ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ
* рдкреИрдЯрд░реНрди рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрддреНрдо-рдзреНрдпрд╛рди рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, RNNs (рдпрд╛ CNNs) рдХреЗ рдмрдЬрд╛рдп (рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдХреЛ рдкреЗрд╢ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкреЗрдкрд░ *[рдзреНрдпрд╛рди рд╣реА рд╕рдм рдХреБрдЫ рд╣реИ](https://arxiv.org/abs/1706.03762)* рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ)

### рд╕реНрдерд┐рддрд┐ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ/рдПрдВрдмреЗрдбрд┐рдВрдЧ

рд╕реНрдерд┐рддрд┐ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИред
1. RNNs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдЯреЛрдХрдиреЛрдВ рдХреА рд╕рд╛рдкреЗрдХреНрд╖ рд╕реНрдерд┐рддрд┐ рдЪрд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдИ рдЬрд╛рддреА рд╣реИ, рдФрд░ рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рджрд░реНрд╢рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред
2. рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЬрдм рд╣рдо рдзреНрдпрд╛рди рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдЯреЛрдХрдиреЛрдВ рдХреА рд╕рд╛рдкреЗрдХреНрд╖ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
3. рд╕реНрдерд┐рддрд┐ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдкрдиреЗ рдЯреЛрдХрдиреЛрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЛ рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдЯреЛрдХрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЗ рд╕рд╛рде рдмрдврд╝рд╛рддреЗ рд╣реИрдВ (рдпрд╛рдиреА, 0, 1, ... рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдЕрдиреБрдХреНрд░рдо)ред
4. рдлрд┐рд░ рд╣рдо рдЯреЛрдХрди рд╕реНрдерд┐рддрд┐ рдХреЛ рдЯреЛрдХрди рдПрдВрдмреЗрдбрд┐рдВрдЧ рд╡реЗрдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рддреЗ рд╣реИрдВред рд╕реНрдерд┐рддрд┐ (рдкреВрд░реНрдгрд╛рдВрдХ) рдХреЛ рд╡реЗрдХреНрдЯрд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╡рд┐рднрд┐рдиреНрди рджреГрд╖реНрдЯрд┐рдХреЛрдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* рдкреНрд░рд╢рд┐рдХреНрд╖рдиреАрдп рдПрдВрдмреЗрдбрд┐рдВрдЧ, рдЬреЛ рдЯреЛрдХрди рдПрдВрдмреЗрдбрд┐рдВрдЧ рдХреЗ рд╕рдорд╛рди рд╣реИред рдпрд╣реА рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣рдо рдпрд╣рд╛рдБ рдорд╛рдирддреЗ рд╣реИрдВред рд╣рдо рдЯреЛрдХрдиреЛрдВ рдФрд░ рдЙрдирдХреЗ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдкрд░ рдПрдВрдмреЗрдбрд┐рдВрдЧ рдкрд░рддреЗрдВ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рдорд╛рди рдЖрдпрд╛рдореЛрдВ рдХреЗ рдПрдВрдмреЗрдбрд┐рдВрдЧ рд╡реЗрдХреНрдЯрд░ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдлрд┐рд░ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред
* рдирд┐рд╢реНрдЪрд┐рдд рд╕реНрдерд┐рддрд┐ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди, рдЬреИрд╕рд╛ рдХрд┐ рдореВрд▓ рдкреЗрдкрд░ рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

<img src="images/pos-embedding.png" width="50%"/>

> рдЪрд┐рддреНрд░ рд▓реЗрдЦрдХ рджреНрд╡рд╛рд░рд╛

рдЬрд┐рд╕ рдкрд░рд┐рдгрд╛рдо рдХреЛ рд╣рдо рд╕реНрдерд┐рддрд┐ рдПрдВрдмреЗрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рд╡рд╣ рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдореВрд▓ рдЯреЛрдХрди рдФрд░ рдЗрд╕рдХреА рд╕реНрдерд┐рддрд┐ рджреЛрдиреЛрдВ рдХреЛ рдПрдВрдмреЗрдб рдХрд░рддрд╛ рд╣реИред

### рдорд▓реНрдЯреА-рд╣реЗрдб рдЖрддреНрдо-рдзреНрдпрд╛рди

рдЕрдЧрд▓рд╛, рд╣рдореЗрдВ рдЕрдкрдиреЗ рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдХреБрдЫ рдкреИрдЯрд░реНрди рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ **рдЖрддреНрдо-рдзреНрдпрд╛рди** рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рдЗрдирдкреБрдЯ рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд╕реА рдЕрдиреБрдХреНрд░рдо рдкрд░ рд▓рд╛рдЧреВ рдзреНрдпрд╛рди рд╣реИред рдЖрддреНрдо-рдзреНрдпрд╛рди рд▓рд╛рдЧреВ рдХрд░рдиреЗ рд╕реЗ рд╣рдореЗрдВ рд╡рд╛рдХреНрдп рдХреЗ рднреАрддрд░ **рд╕рдВрджрд░реНрдн** рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ, рдФрд░ рдпрд╣ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╢рдмреНрдж рдЖрдкрд╕ рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╣рдореЗрдВ рдпрд╣ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╢рдмреНрдж рд╕рд╣рд╕рдВрдмрдВрдзреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрджрд░реНрднрд┐рдд рд╣реИрдВ, рдЬреИрд╕реЗ *рдпрд╣*, рдФрд░ рд╕рдВрджрд░реНрдн рдХреЛ рднреА рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реИрдВ:

![](../../../../../translated_images/CoreferenceResolution.861924d6d384a7d68d8d0039d06a71a151f18a796b8b1330239d3590bd4947eb.hi.png)

> рдЪрд┐рддреНрд░ [Google рдмреНрд▓реЙрдЧ](https://research.googleblog.com/2017/08/transformer-novel-neural-network.html) рд╕реЗ

рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЗрдВ, рд╣рдо **рдорд▓реНрдЯреА-рд╣реЗрдб рдзреНрдпрд╛рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреА рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреА рд╢рдХреНрддрд┐ рджреА рдЬрд╛ рд╕рдХреЗ, рдЬреИрд╕реЗ рдХрд┐ рджреАрд░реНрдШрдХрд╛рд▓рд┐рдХ рдмрдирд╛рдо рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рд╢рдмреНрдж рд╕рдВрдмрдВрдз, рд╕рд╣-рд╕рдВрджрд░реНрдн рдмрдирд╛рдо рдХреБрдЫ рдФрд░, рдЖрджрд┐ред

[TensorFlow рдиреЛрдЯрдмреБрдХ](../../../../../lessons/5-NLP/18-Transformers/TransformersTF.ipynb) рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдкрд░рддреЛрдВ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

### рдПрдиреНрдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ рдзреНрдпрд╛рди

рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЗрдВ, рдзреНрдпрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рджреЛ рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

* рдЖрддреНрдо-рдзреНрдпрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдирдкреБрдЯ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рдкреИрдЯрд░реНрди рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП
* рдЕрдиреБрдХреНрд░рдо рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП - рдпрд╣ рдПрдиреНрдХреЛрдбрд░ рдФрд░ рдбрд┐рдХреЛрдбрд░ рдХреЗ рдмреАрдЪ рдХрд╛ рдзреНрдпрд╛рди рдкрд░рдд рд╣реИред

рдПрдиреНрдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ рдзреНрдпрд╛рди RNNs рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдзреНрдпрд╛рди рддрдВрддреНрд░ рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдПрдирд┐рдореЗрдЯреЗрдб рдЖрд░реЗрдЦ рдПрдиреНрдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ рдзреНрдпрд╛рди рдХреА рднреВрдорд┐рдХрд╛ рдХреЛ рд╕реНрдкрд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред

![рдПрдирд┐рдореЗрдЯреЗрдб GIF рдЬреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдореЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред](../../../../../lessons/5-NLP/18-Transformers/images/transformer-animated-explanation.gif)

рдЪреВрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЗрдирдкреБрдЯ рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдерд┐рддрд┐ рд╕реЗ рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ RNNs рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмреЗрд╣рддрд░ рд╕рдорд╛рдирд╛рдВрддрд░рдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдмрд╣реБрдд рдмрдбрд╝реЗ рдФрд░ рдЕрдзрд┐рдХ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рд╢реАрд▓ рднрд╛рд╖рд╛ рдореЙрдбрд▓ рд╕рдХреНрд╖рдо рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдзреНрдпрд╛рди рд╕рд┐рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢рдмреНрджреЛрдВ рдХреЗ рдмреАрдЪ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрдмрдВрдзреЛрдВ рдХреЛ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЖрдЧреЗ рдХреЗ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддрд╛ рд╣реИред

## BERT

**BERT** (Bidirectional Encoder Representations from Transformers) рдПрдХ рдмрд╣реБрдд рдмрдбрд╝рд╛ рдорд▓реНрдЯреА рд▓реЗрдпрд░ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ *BERT-base* рдХреЗ рд▓рд┐рдП 12 рдкрд░рддреЗрдВ рдФрд░ *BERT-large* рдХреЗ рд▓рд┐рдП 24 рдкрд░рддреЗрдВ рд╣реИрдВред рдореЙрдбрд▓ рдХреЛ рдкрд╣рд▓реЗ рдПрдХ рдмрдбрд╝реЗ рдкрд╛рда рдбреЗрдЯрд╛ (WikiPedia + рдкреБрд╕реНрддрдХреЗрдВ) рдХреЗ рдХреЙрд░реНрдкрд╕ рдкрд░ рдмрд┐рдирд╛ рдкрд░реНрдпрд╡реЗрдХреНрд╖рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдПрдХ рд╡рд╛рдХреНрдп рдореЗрдВ рдорд╛рд╕реНрдХ рдХрд┐рдП рдЧрдП рд╢рдмреНрджреЛрдВ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдирд╛)ред рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рдореЙрдбрд▓ рднрд╛рд╖рд╛ рд╕рдордЭрдиреЗ рдХреЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реНрддрд░реЛрдВ рдХреЛ рдЕрд╡рд╢реЛрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдлрд┐рд░ рдЕрдиреНрдп рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд╕рд╛рде рдлрд╛рдЗрди рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓рд╛рдн рдЙрдард╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рд╣рд╕реНрддрд╛рдВрддрд░рдг рд╢рд┐рдХреНрд╖рдг** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

![рдЪрд┐рддреНрд░ http://jalammar.github.io/illustrated-bert/ рд╕реЗ](../../../../../translated_images/jalammarBERT-language-modeling-masked-lm.34f113ea5fec4362e39ee4381aab7cad06b5465a0b5f053a0f2aa05fbe14e746.hi.png)

> рдЪрд┐рддреНрд░ [рд╕реНрд░реЛрдд](http://jalammar.github.io/illustrated-bert/)

## тЬНя╕П рд╡реНрдпрд╛рдпрд╛рдо: рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдиреЛрдЯрдмреБрдХ рдореЗрдВ рдЕрдкрдиреА рдкрдврд╝рд╛рдИ рдЬрд╛рд░реА рд░рдЦреЗрдВ:

* [PyTorch рдореЗрдВ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░](../../../../../lessons/5-NLP/18-Transformers/TransformersPyTorch.ipynb)
* [TensorFlow рдореЗрдВ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░](../../../../../lessons/5-NLP/18-Transformers/TransformersTF.ipynb)

## рдирд┐рд╖реНрдХрд░реНрд╖

рдЗрд╕ рдкрд╛рда рдореЗрдВ рдЖрдкрдиреЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдФрд░ рдзреНрдпрд╛рди рддрдВрддреНрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реАрдЦрд╛, рдЬреЛ NLP рдЯреВрд▓рдмреЙрдХреНрд╕ рдореЗрдВ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдЙрдкрдХрд░рдг рд╣реИрдВред рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреА рдХрдИ рд╡рд┐рд╡рд┐рдзрддрд╛рдПрдБ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ BERT, DistilBERT, BigBird, OpenGPT3 рдФрд░ рдЕрдиреНрдп рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдлрд╛рдЗрди рдЯреНрдпреВрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [HuggingFace рдкреИрдХреЗрдЬ](https://github.com/huggingface/) рдЗрди рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рд╕реЗ рдХрдИ рдХреЛ PyTorch рдФрд░ TensorFlow рдХреЗ рд╕рд╛рде рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

## ЁЯЪА рдЪреБрдиреМрддреА

## [рдкреЛрд╕реНрдЯ-рд▓реЗрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/218)

## рд╕рдореАрдХреНрд╖рд╛ рдФрд░ рдЖрддреНрдо рдЕрдзреНрдпрдпрди

* [рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://mchromiak.github.io/articles/2017/Sep/12/Transformer-Attention-is-all-you-need/), рдЬреЛ рдХреНрд▓рд╛рд╕рд┐рдХрд▓ [рдзреНрдпрд╛рди рд╣реА рд╕рдм рдХреБрдЫ рд╣реИ](https://arxiv.org/abs/1706.03762) рдкреЗрдкрд░ рдкрд░ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИред
* [рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдкрд░ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛](https://towardsdatascience.com/transformers-explained-visually-part-1-overview-of-functionality-95a6dd460452), рдЬреЛ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╕рдордЭрд╛рддреА рд╣реИред

## [рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ](assignment.md)

**рдЕрд╕реНрд╡реАрдХреГрддрд┐**:  
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдорд╢реАрди-рдЖрдзрд╛рд░рд┐рдд рдПрдЖрдИ рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕рд░рдд рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджреЛрдВ рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдпрд╛ рдЧрд▓рддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЙрд╕рдХреА рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдкреНрд░рд╛рдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рд╣рдо рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рдирд╣реАрдВ рд╣реИрдВред