# рдкреБрдирд░рд╛рд╡реГрддреНрдд рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ

## [рдкреНрд░реА-рд▓реЗрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/116)

рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧреЛрдВ рдореЗрдВ, рд╣рдордиреЗ рдЯреЗрдХреНрд╕реНрдЯ рдХреЗ рд╕рдореГрджреНрдз рдЕрд░реНрдердкреВрд░реНрдг рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдФрд░ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд░реИрдЦрд┐рдХ рд╡рд░реНрдЧреАрдХрд░рдгрдХрд░реНрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИред рдпрд╣ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╡рд╛рдХреНрдп рдореЗрдВ рд╢рдмреНрджреЛрдВ рдХреЗ рд╕рдордЧреНрд░ рдЕрд░реНрде рдХреЛ рдкрдХрдбрд╝рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╢рдмреНрджреЛрдВ рдХреЗ **рдХреНрд░рдо** рдкрд░ рдзреНрдпрд╛рди рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдХреЗ рдКрдкрд░ рдХреА рдПрдХрддреНрд░реАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдиреЗ рдореВрд▓ рдЯреЗрдХреНрд╕реНрдЯ рд╕реЗ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣рдЯрд╛ рджреАред рдЪреВрдВрдХрд┐ рдпреЗ рдореЙрдбрд▓ рд╢рдмреНрджреЛрдВ рдХреЗ рдХреНрд░рдо рдХреЛ рдореЙрдбрд▓ рдХрд░рдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрде рд╣реИрдВ, рд╡реЗ рдЯреЗрдХреНрд╕реНрдЯ рдЬрдирд░реЗрд╢рди рдпрд╛ рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рджреЗрдиреЗ рдЬреИрд╕реЗ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдпрд╛ рдЕрд╕реНрдкрд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред

рдЯреЗрдХреНрд╕реНрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЗ рдЕрд░реНрде рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдЕрдиреНрдп рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ **рдкреБрдирд░рд╛рд╡реГрддреНрдд рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ** рдпрд╛ RNN рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред RNN рдореЗрдВ, рд╣рдо рдЕрдкрдиреЗ рд╡рд╛рдХреНрдп рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдкреНрд░рддреАрдХ рдореЗрдВ рдПрдХ рдмрд╛рд░ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреБрдЫ **рд╕реНрдерд┐рддрд┐** рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдо рдлрд┐рд░ рдЕрдЧрд▓реЗ рдкреНрд░рддреАрдХ рдХреЗ рд╕рд╛рде рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдлрд┐рд░ рд╕реЗ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред

![RNN](../../../../../translated_images/rnn.27f5c29c53d727b546ad3961637a267f0fe9ec5ab01f2a26a853c92fcefbb574.hi.png)

> рдЪрд┐рддреНрд░ рд▓реЗрдЦрдХ рджреНрд╡рд╛рд░рд╛

рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо X<sub>0</sub>,...,X<sub>n</sub> рдХреЗ рд╕рд╛рде, RNN рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рдмреНрд▓реЙрдХреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдмрдирд╛рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдмреИрдХрдкреНрд░реЛрдкрдЧреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдВрдд рд╕реЗ рдЕрдВрдд рддрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдиреЗрдЯрд╡рд░реНрдХ рдмреНрд▓реЙрдХ рдПрдХ рдЬреЛрдбрд╝реА (X<sub>i</sub>,S<sub>i</sub>) рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИ, рдФрд░ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ S<sub>i+1</sub> рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред рдЕрдВрддрд┐рдо рд╕реНрдерд┐рддрд┐ S<sub>n</sub> рдпрд╛ (рдЖрдЙрдЯрдкреБрдЯ Y<sub>n</sub>) рдкрд░рд┐рдгрд╛рдо рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░реИрдЦрд┐рдХ рд╡рд░реНрдЧреАрдХрд░рдгрдХрд░реНрддрд╛ рдореЗрдВ рдЬрд╛рддреА рд╣реИред рд╕рднреА рдиреЗрдЯрд╡рд░реНрдХ рдмреНрд▓реЙрдХреЛрдВ рдХреЗ рдкрд╛рд╕ рд╕рдорд╛рди рд╡рдЬрд╝рди рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдЗрдиреНрд╣реЗрдВ рдПрдХ рдмреИрдХрдкреНрд░реЛрдкрдЧреЗрд╢рди рдкрд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдВрдд рд╕реЗ рдЕрдВрдд рддрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЪреВрдВрдХрд┐ рд╕реНрдерд┐рддрд┐ рд╡реЗрдХреНрдЯрд░ S<sub>0</sub>,...,S<sub>n</sub> рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рд╕ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдпрд╣ рд╢рдмреНрджреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдиреБрдХреНрд░рдорд┐рдХ рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреЛ рд╕реАрдЦрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рд╢рдмреНрдж *not* рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдХрд╣реАрдВ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕реНрдерд┐рддрд┐ рд╡реЗрдХреНрдЯрд░ рдХреЗ рднреАрддрд░ рдХреБрдЫ рддрддреНрд╡реЛрдВ рдХреЛ рдирдХрд╛рд░рд╛рддреНрдордХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрдЦ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдирдХрд╛рд░рд╛рддреНрдордХрддрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИред

> тЬЕ рдЪреВрдВрдХрд┐ рдКрдкрд░ рдЪрд┐рддреНрд░рд┐рдд рд╕рднреА RNN рдмреНрд▓реЙрдХреЛрдВ рдХреЗ рд╡рдЬрд╝рди рд╕рд╛рдЭрд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╣реА рдЪрд┐рддреНрд░ рдХреЛ рдПрдХ рдмреНрд▓реЙрдХ (рджрд╛рдПрдВ) рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдкреБрдирд░рд╛рд╡реГрддреНрдд рдлреАрдбрдмреИрдХ рд▓реВрдк рдХреЗ рд╕рд╛рде рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдерд┐рддрд┐ рдХреЛ рдЗрдирдкреБрдЯ рдкрд░ рд╡рд╛рдкрд╕ рднреЗрдЬрддрд╛ рд╣реИред

## RNN рд╕реЗрд▓ рдХрд╛ рдЖрдХрд╛рд░

рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдПрдХ рд╕рд╛рдзрд╛рд░рдг RNN рд╕реЗрд▓ рдХреИрд╕реЗ рд╕рдВрдЧрдард┐рдд рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдкрд┐рдЫрд▓реЗ рд╕реНрдерд┐рддрд┐ S<sub>i-1</sub> рдФрд░ рд╡рд░реНрддрдорд╛рди рдкреНрд░рддреАрдХ X<sub>i</sub> рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдерд┐рддрд┐ S<sub>i</sub> рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИ (рдФрд░, рдХрднреА-рдХрднреА, рд╣рдо рдХрд┐рд╕реА рдЕрдиреНрдп рдЖрдЙрдЯрдкреБрдЯ Y<sub>i</sub> рдореЗрдВ рднреА рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдЬрдирд░реЗрдЯрд┐рд╡ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ)ред

рдПрдХ рд╕рд╛рдзрд╛рд░рдг RNN рд╕реЗрд▓ рдХреЗ рдЕрдВрджрд░ рджреЛ рд╡рдЬрди рдореИрдЯреНрд░рд┐рдХреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ: рдПрдХ рдЗрдирдкреБрдЯ рдкреНрд░рддреАрдХ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ (рдЗрд╕реЗ W рдХрд╣рддреЗ рд╣реИрдВ), рдФрд░ рджреВрд╕рд░рд╛ рдЗрдирдкреБрдЯ рд╕реНрдерд┐рддрд┐ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ (H)ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ ╧Г(W├ЧX<sub>i</sub>+H├ЧS<sub>i-1</sub>+b) рдХреЗ рд░реВрдк рдореЗрдВ рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд╣рд╛рдБ ╧Г рд╕рдХреНрд░рд┐рдпрдг рдХрд╛рд░реНрдп рд╣реИ рдФрд░ b рдЕрддрд┐рд░рд┐рдХреНрдд рдкреВрд░реНрд╡рд╛рдЧреНрд░рд╣ рд╣реИред

<img alt="RNN Cell Anatomy" src="images/rnn-anatomy.png" width="50%"/>

> рдЪрд┐рддреНрд░ рд▓реЗрдЦрдХ рджреНрд╡рд╛рд░рд╛

рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЗрдирдкреБрдЯ рдЯреЛрдХрди RNN рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рд▓реЗрдпрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рд╕ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдпрд╛рдо рдХреЛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрджрд┐ рдЗрдирдкреБрдЯ рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЖрдпрд╛рдо *emb_size* рд╣реИ, рдФрд░ рд╕реНрдерд┐рддрд┐ рд╡реЗрдХреНрдЯрд░ *hid_size* рд╣реИ - рддреЛ W рдХрд╛ рдЖрдХрд╛рд░ *emb_size*├Ч*hid_size* рд╣реИ, рдФрд░ H рдХрд╛ рдЖрдХрд╛рд░ *hid_size*├Ч*hid_size* рд╣реИред

## рд▓рдВрдмреА рдЫреЛрдЯреА рдЕрд╡рдзрд┐ рдХреА рдореЗрдореЛрд░реА (LSTM)

рдХреНрд▓рд╛рд╕рд┐рдХрд▓ RNNs рдХреА рдПрдХ рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ **рд╡рд┐рд▓реБрдкреНрдд рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ** рд╕рдорд╕реНрдпрд╛ рд╣реИред рдЪреВрдВрдХрд┐ RNNs рдХреЛ рдПрдХ рдмреИрдХрдкреНрд░реЛрдкрдЧреЗрд╢рди рдкрд╛рд╕ рдореЗрдВ рдЕрдВрдд рд╕реЗ рдЕрдВрдд рддрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдкрд╣рд▓реЗ рдХреА рдкрд░рддреЛрдВ рдореЗрдВ рддреНрд░реБрдЯрд┐ рдХреЛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ рд╣реЛрддреА рд╣реИ, рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдиреЗрдЯрд╡рд░реНрдХ рджреВрд░рд╕реНрде рдЯреЛрдХрдиреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдзреЛрдВ рдХреЛ рд╕реАрдЦ рдирд╣реАрдВ рд╕рдХрддрд╛ред рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддрд░реАрдХрд╛ рд╣реИ **рд╕реНрдкрд╖реНрдЯ рд╕реНрдерд┐рддрд┐ рдкреНрд░рдмрдВрдзрди** рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛, рдЬрд┐рд╕реЗ **рдЧреЗрдЯреНрд╕** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рджреЛ рдкреНрд░рд╕рд┐рджреНрдз рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╣реИрдВ: **рд▓рдВрдмреА рдЫреЛрдЯреА рдЕрд╡рдзрд┐ рдХреА рдореЗрдореЛрд░реА** (LSTM) рдФрд░ **рдЧреЗрдЯреЗрдб рд░рд┐рд▓реЗ рдпреВрдирд┐рдЯ** (GRU)ред

![рд▓рдВрдмреА рдЫреЛрдЯреА рдЕрд╡рдзрд┐ рдХреА рдореЗрдореЛрд░реА рд╕реЗрд▓ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддреЗ рд╣реБрдП рдЪрд┐рддреНрд░](../../../../../lessons/5-NLP/16-RNN/images/long-short-term-memory-cell.svg)

> рдЪрд┐рддреНрд░ рд╕реНрд░реЛрдд TBD

LSTM рдиреЗрдЯрд╡рд░реНрдХ RNN рдХреЗ рд╕рдорд╛рди рддрд░реАрдХреЗ рд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рджреЛ рд╕реНрдерд┐рддрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдкрд░рдд рд╕реЗ рдкрд░рдд рдореЗрдВ рдкрд╛рд╕ рдХреА рдЬрд╛рддреА рд╣реИрдВ: рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдерд┐рддрд┐ C, рдФрд░ рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╡реЗрдХреНрдЯрд░ Hред рдкреНрд░рддреНрдпреЗрдХ рдпреВрдирд┐рдЯ рдореЗрдВ, рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╡реЗрдХреНрдЯрд░ H<sub>i</sub> рдХреЛ рдЗрдирдкреБрдЯ X<sub>i</sub> рдХреЗ рд╕рд╛рде рд╕рдВрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╡реЗ рд╕реНрдерд┐рддрд┐ C рдкрд░ **рдЧреЗрдЯреНрд╕** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдЧреЗрдЯ рдПрдХ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рд┐рдЧреНрдореЙрдЗрдб рд╕рдХреНрд░рд┐рдпрдг (рдЖрдЙрдЯрдкреБрдЯ [0,1] рдХреЗ рджрд╛рдпрд░реЗ рдореЗрдВ) рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕реНрдерд┐рддрд┐ рд╡реЗрдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рдЧреБрдгрд╛ рдХрд░рдиреЗ рдкрд░ рдПрдХ рдмрд┐рдЯрд╡рд╛рдЗрдЬ рдорд╛рд╕реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЛрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЧреЗрдЯреНрд╕ рд╣реИрдВ (рдКрдкрд░ рдЪрд┐рддреНрд░ рдореЗрдВ рдмрд╛рдПрдВ рд╕реЗ рджрд╛рдПрдВ):

* **рднреВрд▓рдиреЗ рдХрд╛ рдЧреЗрдЯ** рдПрдХ рдЫрд┐рдкреЗ рд╣реБрдП рд╡реЗрдХреНрдЯрд░ рдХреЛ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рд╡реЗрдХреНрдЯрд░ C рдХреЗ рдХреМрди рд╕реЗ рдШрдЯрдХреЛрдВ рдХреЛ рднреВрд▓рдирд╛ рд╣реИ, рдФрд░ рдХреМрди рд╕реЗ рдШрдЯрдХреЛрдВ рдХреЛ рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реИред
* **рдЗрдирдкреБрдЯ рдЧреЗрдЯ** рдЗрдирдкреБрдЯ рдФрд░ рдЫрд┐рдкреЗ рд╣реБрдП рд╡реЗрдХреНрдЯрд░реЛрдВ рд╕реЗ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИред
* **рдЖрдЙрдЯрдкреБрдЯ рдЧреЗрдЯ** рд╕реНрдерд┐рддрд┐ рдХреЛ *tanh* рд╕рдХреНрд░рд┐рдпрдг рдХреЗ рд╕рд╛рде рдПрдХ рд░реИрдЦрд┐рдХ рдкрд░рдд рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдирдП рд╕реНрдерд┐рддрд┐ C<sub>i+1</sub> рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЫрд┐рдкреЗ рд╣реБрдП рд╡реЗрдХреНрдЯрд░ H<sub>i</sub> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕рдХреЗ рдХреБрдЫ рдШрдЯрдХреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИред

рд╕реНрдерд┐рддрд┐ C рдХреЗ рдШрдЯрдХреЛрдВ рдХреЛ рдХреБрдЫ рдЭрдВрдбреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЛрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЪрд╛рд▓реВ рдФрд░ рдмрдВрдж рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рд╣рдо рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдирд╛рдо *Alice* рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдПрдХ рдорд╣рд┐рд▓рд╛ рдкрд╛рддреНрд░ рдХрд╛ рд╕рдВрджрд░реНрдн рд╣реИ, рдФрд░ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЭрдВрдбрд╛ рдЙрдард╛рддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╛рдХреНрдп рдореЗрдВ рдПрдХ рдорд╣рд┐рд▓рд╛ рд╕рдВрдЬреНрдЮрд╛ рд╣реИред рдЬрдм рд╣рдо рдЖрдЧреЗ *and Tom* рдЬреИрд╕реЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЭрдВрдбрд╛ рдЙрдард╛рддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдмрд╣реБрд╡рдЪрди рд╕рдВрдЬреНрдЮрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕реНрдерд┐рддрд┐ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдХреЗ рд╣рдо рд╕рдВрднрд╡рддрдГ рд╡рд╛рдХреНрдп рдХреЗ рднрд╛рдЧреЛрдВ рдХреА рд╡реНрдпрд╛рдХрд░рдгрд┐рдХ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдЯреНрд░реИрдХ рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВред

> тЬЕ LSTM рдХреЗ рдЖрдВрддрд░рд┐рдХ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрддреНрдХреГрд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди рдЗрд╕ рдорд╣рд╛рди рд▓реЗрдЦ [Understanding LSTM Networks](https://colah.github.io/posts/2015-08-Understanding-LSTMs/) рджреНрд╡рд╛рд░рд╛ рдХреНрд░рд┐рд╕реНрдЯреЛрдлрд░ рдУрд▓рд╛рд╣ рд╣реИред

## рджреНрд╡рд┐рджрд┐рд╢реАрдп рдФрд░ рдорд▓реНрдЯреАрд▓реЗрдпрд░ RNNs

рд╣рдордиреЗ рдЙрди рдкреБрдирд░рд╛рд╡реГрддреНрдд рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рд╣реИ рдЬреЛ рдПрдХ рджрд┐рд╢рд╛ рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВ, рдЕрдиреБрдХреНрд░рдо рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдЕрдВрдд рддрдХред рдпрд╣ рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд▓рдЧрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрд╕ рддрд░реАрдХреЗ рд╕реЗ рдорд┐рд▓рддрд╛-рдЬреБрд▓рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╣рдо рдкрдврд╝рддреЗ рдФрд░ рднрд╛рд╖рдг рд╕реБрдирддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЪреВрдВрдХрд┐ рдХрдИ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд╣рдореЗрдВ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рддрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рджреЛрдиреЛрдВ рджрд┐рд╢рд╛рдУрдВ рдореЗрдВ рдкреБрдирд░рд╛рд╡реГрддреНрдд рдЧрдгрдирд╛ рдХрд░рдирд╛ рд╕рдордЭ рдореЗрдВ рдЖ рд╕рдХрддрд╛ рд╣реИред рдРрд╕реЗ рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рдХреЛ **рджреНрд╡рд┐рджрд┐рд╢реАрдп** RNNs рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рджреНрд╡рд┐рджрд┐рд╢реАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп, рд╣рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рджрд┐рд╢рд╛ рдХреЗ рд▓рд┐рдП рджреЛ рдЫрд┐рдкреА рд╕реНрдерд┐рддрд┐ рд╡реЗрдХреНрдЯрд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред

рдПрдХ рдкреБрдирд░рд╛рд╡реГрддреНрдд рдиреЗрдЯрд╡рд░реНрдХ, рдЪрд╛рд╣реЗ рд╡рд╣ рдПрдХ-рдирд┐рд░реНрджреЗрд╢рд╛рддреНрдордХ рд╣реЛ рдпрд╛ рджреНрд╡рд┐рджрд┐рд╢реАрдп, рдЕрдиреБрдХреНрд░рдо рдХреЗ рднреАрддрд░ рдХреБрдЫ рдкреИрдЯрд░реНрди рдХреЛ рдкрдХрдбрд╝рддрд╛ рд╣реИ, рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕реНрдерд┐рддрд┐ рд╡реЗрдХреНрдЯрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдХрдВрд╡реЛрд▓реНрдпреВрд╢рдирд▓ рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рдХреА рддрд░рд╣, рд╣рдо рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рдкрд░ рдПрдХ рдФрд░ рдкреБрдирд░рд╛рд╡реГрддреНрдд рдкрд░рдд рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдЪреНрдЪ рд╕реНрддрд░ рдХреЗ рдкреИрдЯрд░реНрди рдХреЛ рдкрдХрдбрд╝ рд╕рдХреЗрдВ рдФрд░ рдкрд╣рд▓реЗ рдкрд░рдд рджреНрд╡рд╛рд░рд╛ рдирд┐рдХрд╛рд▓реЗ рдЧрдП рдирд┐рдореНрди-рд╕реНрддрд░реАрдп рдкреИрдЯрд░реНрди рд╕реЗ рдмрдирд╛ рд╕рдХреЗрдВред рдпрд╣ рд╣рдореЗрдВ **рдорд▓реНрдЯреА-рд▓реЗрдпрд░ RNN** рдХреЗ рд╡рд┐рдЪрд╛рд░ рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рджреЛ рдпрд╛ рджреЛ рд╕реЗ рдЕрдзрд┐рдХ рдкреБрдирд░рд╛рд╡реГрддреНрдд рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ, рдЬрд╣рд╛рдБ рдкрд┐рдЫрд▓реЗ рдкрд░рдд рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рдЕрдЧрд▓реА рдкрд░рдд рдореЗрдВ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

![рдорд▓реНрдЯреАрд▓реЗрдпрд░ рд▓рдВрдмреА рдЫреЛрдЯреА рдЕрд╡рдзрд┐ рдХреА рдореЗрдореЛрд░реА RNN рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддреЗ рд╣реБрдП рдЪрд┐рддреНрд░](../../../../../translated_images/multi-layer-lstm.dd975e29bb2a59fe58b429db833932d734c81f211cad2783797a9608984acb8c.hi.jpg)

*рдЪрд┐рддреНрд░ [рдЗрд╕ рдЕрджреНрднреБрдд рдкреЛрд╕реНрдЯ](https://towardsdatascience.com/from-a-lstm-cell-to-a-multilayer-lstm-network-with-pytorch-2899eb5696f3) рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдлрд░реНрдирд╛рдВрдбреЛ рд▓реЛрдкреЗрдЬрд╝ рджреНрд╡рд╛рд░рд╛ рд╣реИ*

## тЬНя╕П рдЕрднреНрдпрд╛рд╕: рдПрдореНрдмреЗрдбрд┐рдВрдЧ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдиреЛрдЯрдмреБрдХ рдореЗрдВ рдЕрдкрдиреА рд╕реАрдЦ рдЬрд╛рд░реА рд░рдЦреЗрдВ:

* [PyTorch рдХреЗ рд╕рд╛рде RNNs](../../../../../lessons/5-NLP/16-RNN/RNNPyTorch.ipynb)
* [TensorFlow рдХреЗ рд╕рд╛рде RNNs](../../../../../lessons/5-NLP/16-RNN/RNNTF.ipynb)

## рдирд┐рд╖реНрдХрд░реНрд╖

рдЗрд╕ рдЗрдХрд╛рдИ рдореЗрдВ, рд╣рдордиреЗ рджреЗрдЦрд╛ рдХрд┐ RNNs рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреБрдХреНрд░рдо рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╡реЗ рдХрдИ рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдЯреЗрдХреНрд╕реНрдЯ рдЬрдирд░реЗрд╢рди, рдорд╢реАрди рдЕрдиреБрд╡рд╛рдж, рдФрд░ рдЕрдзрд┐рдХред рд╣рдо рдЕрдЧрд▓реЗ рдЗрдХрд╛рдИ рдореЗрдВ рдЙрди рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗред

## ЁЯЪА рдЪреБрдиреМрддреА

LSTMs рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рд╕рд╛рд╣рд┐рддреНрдп рдкрдврд╝реЗрдВ рдФрд░ рдЙрдирдХреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:

- [рдЧреНрд░рд┐рдб рд▓рдВрдмреА рдЫреЛрдЯреА рдЕрд╡рдзрд┐ рдХреА рдореЗрдореЛрд░реА](https://arxiv.org/pdf/1507.01526v1.pdf)
- [рджрд┐рдЦрд╛рдПрдВ, рдзреНрдпрд╛рди рджреЗрдВ рдФрд░ рдмрддрд╛рдПрдВ: рджреГрд╢реНрдп рдзреНрдпрд╛рди рдХреЗ рд╕рд╛рде рдиреНрдпреВрд░рд▓ рдЗрдореЗрдЬ рдХреИрдкреНрд╢рди рдЬрдирд░реЗрд╢рди](https://arxiv.org/pdf/1502.03044v2.pdf)

## [рдкреЛрд╕реНрдЯ-рд▓реЗрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/216)

## рд╕рдореАрдХреНрд╖рд╛ рдФрд░ рдЖрддреНрдо рдЕрдзреНрдпрдпрди

- [LSTM рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рд╕рдордЭрдирд╛](https://colah.github.io/posts/2015-08-Understanding-LSTMs/) рдХреНрд░рд┐рд╕реНрдЯреЛрдлрд░ рдУрд▓рд╛рд╣ рджреНрд╡рд╛рд░рд╛ред

## [рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ: рдиреЛрдЯрдмреБрдХ](assignment.md)

**рдЕрд╕реНрд╡реАрдХреГрддрд┐**:  
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдорд╢реАрди-рдЖрдзрд╛рд░рд┐рдд рдПрдЖрдИ рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕рд░рдд рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдпрд╛ рдЕрд╕рдВрдЧрддрддрд╛рдПрдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЙрд╕рдХреА рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдкреНрд░рд╛рдорд╛рдгрд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЬрд┐рдореНрдореЗрджрд╛рд░ рдирд╣реАрдВ рд╣реИрдВред