# Máº¡ng ÄÆ°á»£c Huáº¥n Luyá»‡n Sáºµn vÃ  Há»c Chuyá»ƒn Giao

Huáº¥n luyá»‡n CNN cÃ³ thá»ƒ máº¥t ráº¥t nhiá»u thá»i gian vÃ  yÃªu cáº§u má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u. Tuy nhiÃªn, pháº§n lá»›n thá»i gian Ä‘Æ°á»£c dÃ nh Ä‘á»ƒ há»c cÃ¡c bá»™ lá»c cáº¥p tháº¥p tá»‘t nháº¥t mÃ  máº¡ng cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ trÃ­ch xuáº¥t cÃ¡c máº«u tá»« hÃ¬nh áº£nh. Má»™t cÃ¢u há»i tá»± nhiÃªn Ä‘Æ°á»£c Ä‘áº·t ra - liá»‡u chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng má»™t máº¡ng nÆ¡-ron Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn má»™t táº­p dá»¯ liá»‡u vÃ  Ä‘iá»u chá»‰nh nÃ³ Ä‘á»ƒ phÃ¢n loáº¡i cÃ¡c hÃ¬nh áº£nh khÃ¡c mÃ  khÃ´ng cáº§n má»™t quÃ¡ trÃ¬nh huáº¥n luyá»‡n Ä‘áº§y Ä‘á»§?

## [CÃ¢u há»i trÆ°á»›c bÃ i giáº£ng](https://ff-quizzes.netlify.app/en/ai/quiz/15)

PhÆ°Æ¡ng phÃ¡p nÃ y Ä‘Æ°á»£c gá»i lÃ  **há»c chuyá»ƒn giao**, bá»Ÿi vÃ¬ chÃºng ta chuyá»ƒn má»™t sá»‘ kiáº¿n thá»©c tá»« má»™t mÃ´ hÃ¬nh máº¡ng nÆ¡-ron sang má»™t mÃ´ hÃ¬nh khÃ¡c. Trong há»c chuyá»ƒn giao, chÃºng ta thÆ°á»ng báº¯t Ä‘áº§u vá»›i má»™t mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n sáºµn, Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn má»™t táº­p dá»¯ liá»‡u hÃ¬nh áº£nh lá»›n, cháº³ng háº¡n nhÆ° **ImageNet**. Nhá»¯ng mÃ´ hÃ¬nh nÃ y Ä‘Ã£ cÃ³ kháº£ nÄƒng tá»‘t trong viá»‡c trÃ­ch xuáº¥t cÃ¡c Ä‘áº·c Ä‘iá»ƒm tá»« hÃ¬nh áº£nh chung, vÃ  trong nhiá»u trÆ°á»ng há»£p, chá»‰ cáº§n xÃ¢y dá»±ng má»™t bá»™ phÃ¢n loáº¡i dá»±a trÃªn nhá»¯ng Ä‘áº·c Ä‘iá»ƒm Ä‘Ã£ trÃ­ch xuáº¥t cÃ³ thá»ƒ mang láº¡i káº¿t quáº£ tá»‘t.

> âœ… Há»c chuyá»ƒn giao lÃ  má»™t thuáº­t ngá»¯ báº¡n cÃ³ thá»ƒ gáº·p trong cÃ¡c lÄ©nh vá»±c há»c thuáº­t khÃ¡c, cháº³ng háº¡n nhÆ° GiÃ¡o dá»¥c. NÃ³ Ä‘á» cáº­p Ä‘áº¿n quÃ¡ trÃ¬nh láº¥y kiáº¿n thá»©c tá»« má»™t lÄ©nh vá»±c vÃ  Ã¡p dá»¥ng nÃ³ vÃ o lÄ©nh vá»±c khÃ¡c.

## MÃ´ HÃ¬nh ÄÆ°á»£c Huáº¥n Luyá»‡n Sáºµn NhÆ° CÃ¡c Bá»™ TrÃ­ch Xuáº¥t Äáº·c Äiá»ƒm

CÃ¡c máº¡ng tÃ­ch cháº­p mÃ  chÃºng ta Ä‘Ã£ tháº£o luáº­n trong pháº§n trÆ°á»›c bao gá»“m má»™t sá»‘ lá»›p, má»—i lá»›p Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ trÃ­ch xuáº¥t má»™t sá»‘ Ä‘áº·c Ä‘iá»ƒm tá»« hÃ¬nh áº£nh, báº¯t Ä‘áº§u tá»« cÃ¡c tá»• há»£p pixel cáº¥p tháº¥p (cháº³ng háº¡n nhÆ° Ä‘Æ°á»ng ngang/dá»c hoáº·c nÃ©t váº½), cho Ä‘áº¿n cÃ¡c tá»• há»£p Ä‘áº·c Ä‘iá»ƒm cáº¥p cao hÆ¡n, tÆ°Æ¡ng á»©ng vá»›i nhá»¯ng thá»© nhÆ° máº¯t cá»§a má»™t ngá»n lá»­a. Náº¿u chÃºng ta huáº¥n luyá»‡n CNN trÃªn má»™t táº­p dá»¯ liá»‡u Ä‘á»§ lá»›n vÃ  Ä‘a dáº¡ng, máº¡ng sáº½ há»c cÃ¡ch trÃ­ch xuáº¥t nhá»¯ng Ä‘áº·c Ä‘iá»ƒm chung Ä‘Ã³.

Cáº£ Keras vÃ  PyTorch Ä‘á»u cÃ³ cÃ¡c hÃ m Ä‘á»ƒ dá»… dÃ ng táº£i trá»ng sá»‘ máº¡ng nÆ¡-ron Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n sáºµn cho má»™t sá»‘ kiáº¿n trÃºc phá»• biáº¿n, háº§u háº¿t Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn hÃ¬nh áº£nh ImageNet. Nhá»¯ng kiáº¿n trÃºc thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng nháº¥t Ä‘Æ°á»£c mÃ´ táº£ trÃªn trang [Kiáº¿n TrÃºc CNN](../07-ConvNets/CNN_Architectures.md) tá»« bÃ i há»c trÆ°á»›c. Äáº·c biá»‡t, báº¡n cÃ³ thá»ƒ cÃ¢n nháº¯c sá»­ dá»¥ng má»™t trong nhá»¯ng kiáº¿n trÃºc sau:

* **VGG-16/VGG-19** lÃ  cÃ¡c mÃ´ hÃ¬nh tÆ°Æ¡ng Ä‘á»‘i Ä‘Æ¡n giáº£n nhÆ°ng váº«n mang láº¡i Ä‘á»™ chÃ­nh xÃ¡c tá»‘t. ThÆ°á»ng thÃ¬ sá»­ dá»¥ng VGG nhÆ° má»™t thá»­ nghiá»‡m Ä‘áº§u tiÃªn lÃ  má»™t lá»±a chá»n tá»‘t Ä‘á»ƒ xem há»c chuyá»ƒn giao hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o.
* **ResNet** lÃ  má»™t há» mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘á» xuáº¥t bá»Ÿi Microsoft Research vÃ o nÄƒm 2015. ChÃºng cÃ³ nhiá»u lá»›p hÆ¡n, vÃ  do Ä‘Ã³ yÃªu cáº§u nhiá»u tÃ i nguyÃªn hÆ¡n.
* **MobileNet** lÃ  má»™t há» mÃ´ hÃ¬nh cÃ³ kÃ­ch thÆ°á»›c giáº£m, phÃ¹ há»£p cho cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng. Sá»­ dá»¥ng chÃºng náº¿u báº¡n thiáº¿u tÃ i nguyÃªn vÃ  cÃ³ thá»ƒ cháº¥p nháº­n giáº£m má»™t chÃºt Ä‘á»™ chÃ­nh xÃ¡c.

DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c Ä‘áº·c Ä‘iá»ƒm máº«u Ä‘Æ°á»£c trÃ­ch xuáº¥t tá»« má»™t bá»©c áº£nh cá»§a má»™t con mÃ¨o bá»Ÿi máº¡ng VGG-16:

![CÃ¡c Ä‘áº·c Ä‘iá»ƒm Ä‘Æ°á»£c trÃ­ch xuáº¥t bá»Ÿi VGG-16](../../../../../translated_images/vi/features.6291f9c7ba3a0b95.webp)

## Táº­p Dá»¯ Liá»‡u MÃ¨o vÃ  ChÃ³

Trong vÃ­ dá»¥ nÃ y, chÃºng ta sáº½ sá»­ dá»¥ng má»™t táº­p dá»¯ liá»‡u vá» [MÃ¨o vÃ  ChÃ³](https://www.microsoft.com/download/details.aspx?id=54765&WT.mc_id=academic-77998-cacaste), ráº¥t gáº§n vá»›i má»™t ká»‹ch báº£n phÃ¢n loáº¡i hÃ¬nh áº£nh thá»±c táº¿.

## âœï¸ BÃ i Táº­p: Há»c Chuyá»ƒn Giao

HÃ£y xem há»c chuyá»ƒn giao hoáº¡t Ä‘á»™ng trong cÃ¡c notebook tÆ°Æ¡ng á»©ng:

* [Há»c Chuyá»ƒn Giao - PyTorch](TransferLearningPyTorch.ipynb)
* [Há»c Chuyá»ƒn Giao - TensorFlow](TransferLearningTF.ipynb)

## HÃ¬nh áº¢nh MÃ¨o Äá»‘i KhÃ¡ng

Máº¡ng nÆ¡-ron Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n sáºµn chá»©a cÃ¡c máº«u khÃ¡c nhau bÃªn trong "bá»™ nÃ£o" cá»§a nÃ³, bao gá»“m cÃ¡c khÃ¡i niá»‡m vá» **mÃ¨o lÃ½ tÆ°á»Ÿng** (cÅ©ng nhÆ° chÃ³ lÃ½ tÆ°á»Ÿng, ngá»±a váº±n lÃ½ tÆ°á»Ÿng, v.v.). Sáº½ ráº¥t thÃº vá»‹ náº¿u cÃ³ thá»ƒ **hÃ¬nh dung hÃ¬nh áº£nh nÃ y**. Tuy nhiÃªn, Ä‘iá»u nÃ y khÃ´ng Ä‘Æ¡n giáº£n, bá»Ÿi vÃ¬ cÃ¡c máº«u Ä‘Æ°á»£c phÃ¢n bá»‘ kháº¯p cÃ¡c trá»ng sá»‘ cá»§a máº¡ng, vÃ  cÅ©ng Ä‘Æ°á»£c tá»• chá»©c theo cáº¥u trÃºc phÃ¢n cáº¥p.

Má»™t cÃ¡ch tiáº¿p cáº­n mÃ  chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n lÃ  báº¯t Ä‘áº§u vá»›i má»™t hÃ¬nh áº£nh ngáº«u nhiÃªn, sau Ä‘Ã³ cá»‘ gáº¯ng sá»­ dá»¥ng ká»¹ thuáº­t **tá»‘i Æ°u hÃ³a gradient descent** Ä‘á»ƒ Ä‘iá»u chá»‰nh hÃ¬nh áº£nh Ä‘Ã³ sao cho máº¡ng báº¯t Ä‘áº§u nghÄ© ráº±ng Ä‘Ã³ lÃ  má»™t con mÃ¨o.

![VÃ²ng láº·p tá»‘i Æ°u hÃ³a hÃ¬nh áº£nh](../../../../../translated_images/vi/ideal-cat-loop.999fbb8ff306e044.webp)

Tuy nhiÃªn, náº¿u chÃºng ta lÃ m Ä‘iá»u nÃ y, chÃºng ta sáº½ nháº­n Ä‘Æ°á»£c má»™t thá»© ráº¥t giá»‘ng vá»›i nhiá»…u ngáº«u nhiÃªn. Äiá»u nÃ y lÃ  do *cÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ khiáº¿n máº¡ng nghÄ© ráº±ng hÃ¬nh áº£nh Ä‘áº§u vÃ o lÃ  má»™t con mÃ¨o*, bao gá»“m má»™t sá»‘ cÃ¡ch khÃ´ng cÃ³ Ã½ nghÄ©a vá» máº·t thá»‹ giÃ¡c. Máº·c dÃ¹ nhá»¯ng hÃ¬nh áº£nh nÃ y chá»©a nhiá»u máº«u Ä‘áº·c trÆ°ng cho má»™t con mÃ¨o, nhÆ°ng khÃ´ng cÃ³ gÃ¬ rÃ ng buá»™c chÃºng pháº£i rÃµ rÃ ng vá» máº·t thá»‹ giÃ¡c.

Äá»ƒ cáº£i thiá»‡n káº¿t quáº£, chÃºng ta cÃ³ thá»ƒ thÃªm má»™t thuáº­t ngá»¯ khÃ¡c vÃ o hÃ m máº¥t mÃ¡t, Ä‘Æ°á»£c gá»i lÃ  **máº¥t mÃ¡t biáº¿n Ä‘á»•i**. ÄÃ¢y lÃ  má»™t chá»‰ sá»‘ cho tháº¥y má»©c Ä‘á»™ tÆ°Æ¡ng Ä‘á»“ng giá»¯a cÃ¡c pixel lÃ¢n cáº­n cá»§a hÃ¬nh áº£nh. Viá»‡c giáº£m thiá»ƒu máº¥t mÃ¡t biáº¿n Ä‘á»•i lÃ m cho hÃ¬nh áº£nh mÆ°á»£t mÃ  hÆ¡n vÃ  loáº¡i bá» nhiá»…u - tá»« Ä‘Ã³ lÃ m lá»™ ra cÃ¡c máº«u háº¥p dáº«n hÆ¡n vá» máº·t thá»‹ giÃ¡c. DÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ vá» cÃ¡c hÃ¬nh áº£nh "lÃ½ tÆ°á»Ÿng" nhÆ° váº­y, Ä‘Æ°á»£c phÃ¢n loáº¡i lÃ  mÃ¨o vÃ  ngá»±a váº±n vá»›i xÃ¡c suáº¥t cao:

![MÃ¨o LÃ½ TÆ°á»Ÿng](../../../../../translated_images/vi/ideal-cat.203dd4597643d6b0.webp) | ![Ngá»±a Váº±n LÃ½ TÆ°á»Ÿng](../../../../../translated_images/vi/ideal-zebra.7f70e8b54ee15a7a.webp)
-----|-----
 *MÃ¨o LÃ½ TÆ°á»Ÿng* | *Ngá»±a Váº±n LÃ½ TÆ°á»Ÿng*

CÃ¡ch tiáº¿p cáº­n tÆ°Æ¡ng tá»± cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡i gá»i lÃ  **táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng** trÃªn máº¡ng nÆ¡-ron. Giáº£ sá»­ chÃºng ta muá»‘n Ä‘Ã¡nh lá»«a má»™t máº¡ng nÆ¡-ron vÃ  lÃ m cho má»™t con chÃ³ trÃ´ng giá»‘ng nhÆ° má»™t con mÃ¨o. Náº¿u chÃºng ta láº¥y hÃ¬nh áº£nh cá»§a má»™t con chÃ³, Ä‘Æ°á»£c máº¡ng nháº­n diá»‡n lÃ  má»™t con chÃ³, chÃºng ta cÃ³ thá»ƒ Ä‘iá»u chá»‰nh nÃ³ má»™t chÃºt báº±ng cÃ¡ch sá»­ dá»¥ng tá»‘i Æ°u hÃ³a gradient descent, cho Ä‘áº¿n khi máº¡ng báº¯t Ä‘áº§u phÃ¢n loáº¡i nÃ³ lÃ  má»™t con mÃ¨o:

![HÃ¬nh áº£nh cá»§a má»™t con chÃ³](../../../../../translated_images/vi/original-dog.8f68a67d2fe0911f.webp) | ![HÃ¬nh áº£nh cá»§a má»™t con chÃ³ Ä‘Æ°á»£c phÃ¢n loáº¡i lÃ  mÃ¨o](../../../../../translated_images/vi/adversarial-dog.d9fc7773b0142b89.webp)
-----|-----
*HÃ¬nh áº£nh gá»‘c cá»§a má»™t con chÃ³* | *HÃ¬nh áº£nh cá»§a má»™t con chÃ³ Ä‘Æ°á»£c phÃ¢n loáº¡i lÃ  mÃ¨o*

Xem mÃ£ Ä‘á»ƒ tÃ¡i táº¡o cÃ¡c káº¿t quáº£ trÃªn trong notebook sau:

* [MÃ¨o LÃ½ TÆ°á»Ÿng vÃ  Äá»‘i KhÃ¡ng - TensorFlow](AdversarialCat_TF.ipynb)

## Káº¿t Luáº­n

Sá»­ dá»¥ng há»c chuyá»ƒn giao, báº¡n cÃ³ thá»ƒ nhanh chÃ³ng táº¡o ra má»™t bá»™ phÃ¢n loáº¡i cho nhiá»‡m vá»¥ phÃ¢n loáº¡i Ä‘á»‘i tÆ°á»£ng tÃ¹y chá»‰nh vÃ  Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ chÃ­nh xÃ¡c cao. Báº¡n cÃ³ thá»ƒ tháº¥y ráº±ng cÃ¡c nhiá»‡m vá»¥ phá»©c táº¡p hÆ¡n mÃ  chÃºng ta Ä‘ang giáº£i quyáº¿t hiá»‡n nay yÃªu cáº§u sá»©c máº¡nh tÃ­nh toÃ¡n cao hÆ¡n, vÃ  khÃ´ng thá»ƒ dá»… dÃ ng giáº£i quyáº¿t trÃªn CPU. Trong Ä‘Æ¡n vá»‹ tiáº¿p theo, chÃºng ta sáº½ thá»­ sá»­ dá»¥ng má»™t triá»ƒn khai nháº¹ hÆ¡n Ä‘á»ƒ huáº¥n luyá»‡n cÃ¹ng má»™t mÃ´ hÃ¬nh vá»›i tÃ i nguyÃªn tÃ­nh toÃ¡n tháº¥p hÆ¡n, dáº«n Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c chá»‰ giáº£m nháº¹.

## ğŸš€ Thá»­ ThÃ¡ch

Trong cÃ¡c notebook Ä‘i kÃ¨m, cÃ³ cÃ¡c ghi chÃº á»Ÿ cuá»‘i vá» cÃ¡ch kiáº¿n thá»©c chuyá»ƒn giao hoáº¡t Ä‘á»™ng tá»‘t nháº¥t vá»›i dá»¯ liá»‡u huáº¥n luyá»‡n tÆ°Æ¡ng Ä‘á»‘i giá»‘ng nhau (cháº³ng háº¡n nhÆ° má»™t loáº¡i Ä‘á»™ng váº­t má»›i). HÃ£y thá»­ nghiá»‡m vá»›i cÃ¡c loáº¡i hÃ¬nh áº£nh hoÃ n toÃ n má»›i Ä‘á»ƒ xem mÃ´ hÃ¬nh kiáº¿n thá»©c chuyá»ƒn giao cá»§a báº¡n hoáº¡t Ä‘á»™ng tá»‘t hay kÃ©m nhÆ° tháº¿ nÃ o.

## [CÃ¢u há»i sau bÃ i giáº£ng](https://ff-quizzes.netlify.app/en/ai/quiz/16)

## Ã”n Táº­p & Tá»± Há»c

Äá»c qua [TrainingTricks.md](TrainingTricks.md) Ä‘á»ƒ nÃ¢ng cao kiáº¿n thá»©c cá»§a báº¡n vá» má»™t sá»‘ cÃ¡ch khÃ¡c Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh.

## [BÃ i Táº­p](lab/README.md)

Trong bÃ i thá»±c hÃ nh nÃ y, chÃºng ta sáº½ sá»­ dá»¥ng táº­p dá»¯ liá»‡u thá»±c táº¿ [Oxford-IIIT](https://www.robots.ox.ac.uk/~vgg/data/pets/) vá» thÃº cÆ°ng vá»›i 35 giá»‘ng mÃ¨o vÃ  chÃ³, vÃ  chÃºng ta sáº½ xÃ¢y dá»±ng má»™t bá»™ phÃ¢n loáº¡i há»c chuyá»ƒn giao.

---

